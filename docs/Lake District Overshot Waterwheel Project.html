<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.537">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Solving Engineering Problemsusing Python - Lake District Overshot Waterwheel ProjectReview and Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Solving Engineering Problems<br>using Python</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./source.html"> 
<span class="menu-text">Source</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#scope" id="toc-scope" class="nav-link" data-scroll-target="#scope"><span class="header-section-number">1.1</span> Scope</a></li>
  <li><a href="#review-of-videos" id="toc-review-of-videos" class="nav-link" data-scroll-target="#review-of-videos"><span class="header-section-number">1.2</span> Review of videos</a></li>
  <li><a href="#units" id="toc-units" class="nav-link" data-scroll-target="#units"><span class="header-section-number">1.3</span> Units</a></li>
  <li><a href="#variables-and-constants" id="toc-variables-and-constants" class="nav-link" data-scroll-target="#variables-and-constants"><span class="header-section-number">1.4</span> Variables and constants</a></li>
  <li><a href="#python-package-versions" id="toc-python-package-versions" class="nav-link" data-scroll-target="#python-package-versions"><span class="header-section-number">1.5</span> Python package versions</a></li>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology"><span class="header-section-number">1.6</span> Terminology</a></li>
  </ul></li>
  <li><a href="#gravitational-power-of-water" id="toc-gravitational-power-of-water" class="nav-link" data-scroll-target="#gravitational-power-of-water"><span class="header-section-number">2</span> Gravitational power of water</a>
  <ul class="collapse">
  <li><a href="#verifying-kriss-estimated-power-versus-flow-rate" id="toc-verifying-kriss-estimated-power-versus-flow-rate" class="nav-link" data-scroll-target="#verifying-kriss-estimated-power-versus-flow-rate"><span class="header-section-number">2.1</span> Verifying Kris’s estimated power versus flow rate</a></li>
  </ul></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies"><span class="header-section-number">3</span> Case studies</a></li>
  <li><a href="#hydro-system-analysis" id="toc-hydro-system-analysis" class="nav-link" data-scroll-target="#hydro-system-analysis"><span class="header-section-number">4</span> Hydro system analysis</a>
  <ul class="collapse">
  <li><a href="#efficiencies" id="toc-efficiencies" class="nav-link" data-scroll-target="#efficiencies"><span class="header-section-number">4.1</span> Efficiencies</a></li>
  <li><a href="#design-parameters" id="toc-design-parameters" class="nav-link" data-scroll-target="#design-parameters"><span class="header-section-number">4.2</span> Design parameters</a></li>
  <li><a href="#instrumentation" id="toc-instrumentation" class="nav-link" data-scroll-target="#instrumentation"><span class="header-section-number">4.3</span> Instrumentation</a>
  <ul class="collapse">
  <li><a href="#inverter" id="toc-inverter" class="nav-link" data-scroll-target="#inverter"><span class="header-section-number">4.3.1</span> Inverter</a></li>
  <li><a href="#electrical-load-for-analysis-and-testing" id="toc-electrical-load-for-analysis-and-testing" class="nav-link" data-scroll-target="#electrical-load-for-analysis-and-testing"><span class="header-section-number">4.3.2</span> Electrical load for analysis and testing</a></li>
  </ul></li>
  <li><a href="#gear-box" id="toc-gear-box" class="nav-link" data-scroll-target="#gear-box"><span class="header-section-number">4.4</span> Gear box</a></li>
  <li><a href="#generator-and-rectifier-voltage" id="toc-generator-and-rectifier-voltage" class="nav-link" data-scroll-target="#generator-and-rectifier-voltage"><span class="header-section-number">4.5</span> Generator and rectifier voltage</a></li>
  <li><a href="#water-wheel" id="toc-water-wheel" class="nav-link" data-scroll-target="#water-wheel"><span class="header-section-number">4.6</span> Water wheel</a>
  <ul class="collapse">
  <li><a href="#water-carring-capacity-vs-rpm" id="toc-water-carring-capacity-vs-rpm" class="nav-link" data-scroll-target="#water-carring-capacity-vs-rpm"><span class="header-section-number">4.6.1</span> Water carring capacity vs rpm</a></li>
  </ul></li>
  <li><a href="#power-equilibrium" id="toc-power-equilibrium" class="nav-link" data-scroll-target="#power-equilibrium"><span class="header-section-number">4.7</span> Power equilibrium</a>
  <ul class="collapse">
  <li><a href="#water-wheel-torque-vs-rpm" id="toc-water-wheel-torque-vs-rpm" class="nav-link" data-scroll-target="#water-wheel-torque-vs-rpm"><span class="header-section-number">4.7.1</span> Water wheel torque vs rpm</a></li>
  <li><a href="#water-wheel-shaft-power-vs-rpm" id="toc-water-wheel-shaft-power-vs-rpm" class="nav-link" data-scroll-target="#water-wheel-shaft-power-vs-rpm"><span class="header-section-number">4.7.2</span> Water wheel shaft power vs rpm</a></li>
  <li><a href="#wheel-tangential-velocity-vs-rpm" id="toc-wheel-tangential-velocity-vs-rpm" class="nav-link" data-scroll-target="#wheel-tangential-velocity-vs-rpm"><span class="header-section-number">4.7.3</span> Wheel tangential velocity vs RPM</a></li>
  </ul></li>
  <li><a href="#generator" id="toc-generator" class="nav-link" data-scroll-target="#generator"><span class="header-section-number">4.8</span> Generator</a>
  <ul class="collapse">
  <li><a href="#kw-3-phase-pmg-220v96v-types" id="toc-kw-3-phase-pmg-220v96v-types" class="nav-link" data-scroll-target="#kw-3-phase-pmg-220v96v-types"><span class="header-section-number">4.8.1</span> 2kW 3 phase PMG, 220V/96V types</a></li>
  <li><a href="#self-excited-induction-generator-seig" id="toc-self-excited-induction-generator-seig" class="nav-link" data-scroll-target="#self-excited-induction-generator-seig"><span class="header-section-number">4.8.2</span> Self-excited induction generator (SEIG)</a></li>
  </ul></li>
  <li><a href="#the-flume" id="toc-the-flume" class="nav-link" data-scroll-target="#the-flume"><span class="header-section-number">4.9</span> The flume</a>
  <ul class="collapse">
  <li><a href="#flume-slope" id="toc-flume-slope" class="nav-link" data-scroll-target="#flume-slope"><span class="header-section-number">4.9.1</span> Flume slope</a></li>
  <li><a href="#flume-re-design" id="toc-flume-re-design" class="nav-link" data-scroll-target="#flume-re-design"><span class="header-section-number">4.9.2</span> Flume re-design</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#safety" id="toc-safety" class="nav-link" data-scroll-target="#safety"><span class="header-section-number">5</span> Safety</a></li>
  <li><a href="#maintenance" id="toc-maintenance" class="nav-link" data-scroll-target="#maintenance"><span class="header-section-number">6</span> Maintenance</a></li>
  <li><a href="#economic-analysis" id="toc-economic-analysis" class="nav-link" data-scroll-target="#economic-analysis"><span class="header-section-number">7</span> Economic analysis</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">8</span> Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Lake District Overshot Waterwheel Project<br>Review and Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Last update: 26 Jan 2024</p>
<ul>
<li>This notebook is a draft copy and only half baked.</li>
<li>Spelling and grammar checks have not been completed.</li>
<li>The math still needs a final check.</li>
<li>This notebook is posted for testing only.<br>
</li>
<li>Some code cells are hidden so as to not distract the reader.</li>
<li>The remaining code cells can be viewed by clicking on the &lt;/&gt;Code to the left of the title and selecting show all code.</li>
<li>Individual code blocks can be viewed by toggleing the &gt;Code button.<br>
</li>
</ul>
</div>
</div>
<section id="abstract" class="level1 unnumbered">
<h1 class="unnumbered">Abstract</h1>
<p>This Jupyter notebook examines the design of a small hydroelectric water wheel built by <a href="https://www.krisharbour.co.uk/">Kris Harbour Natural Building</a>. The water wheel is a 2.1 meter diameter wheel and he expected to generate between 1.5 and 1.7 kW. The project is documented in five YouTube videos, links are here: <a href="https://www.youtube.com/watch?v=7l5xxIGiW7o">Part 1</a>, <a href="https://www.youtube.com/watch?v=PvgeSJKlNUs">Part 2</a>, <a href="https://www.youtube.com/watch?v=DInwut0DzTQ">Part 3</a>, <a href="https://www.youtube.com/watch?v=WPICp3c_qIQ">Part 4</a> and <a href="https://www.youtube.com/watch?v=RWTgMWRc2W4">Part 5</a>. The videos provide some technical details, but not enough to satisfy me. My JupyterLab notebook will cover the project description, the water wheel design, generator, flume, inverter and other topics he did not address such as instrumentation, safety, maintenance, reliability and economics.</p>
<div id="fig-video_Screenshot_2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-video_Screenshot_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="video_Screenshot_2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-video_Screenshot_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Water wheel, flume and spillway
</figcaption>
</figure>
</div>
<p><a href="#fig-video_Screenshot_2" class="quarto-xref">Figure&nbsp;1</a>, taken from part 3 of the video series, shows the water wheel, flume and the spillway. There are a couple of notable features shown in the photo. There is a substantial amount of water splashing from the buckets and the buckets look only half full. The flow in the flume is turblent as the water makes the turn towards the top of the wheel. The depth of the water in the flume looks like it’s about 25 mm. At this point in the project, Kris installed a noozle to help guide the water into the buckets. The generator, gear box and generator are under the gray cover.</p>
</section>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This notebook will review a few technical aspects of the project. I’ll try not to be too much of an <a href="https://en.wiktionary.org/wiki/armchair_quarterback">armchair quarterback</a>, since Kris does a good job of stating his frustrations as he narrates his videos. Over all, this is a very interesting project. The craftmanship and construction of the water wheel is very good. I think most of the issues are with other aspects of the project. The root issue was not to characterize the generator prior to finalizing the design of the waterwheel. This led to post installation modifications to the generator mounting bracket, the cover and pulleys. As a result the gear ratio is too low. Also, the design of the flume is not optimal since the water velocity is too high.</p>
<p>The important technical aspects for the water wheel, gear box and generator have been summarized in the table below:</p>
<div id="tbl-tech-parm" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tech-parm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Key technical aspects
</figcaption>
<div aria-describedby="tbl-tech-parm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Value</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Wheel diameter</td>
<td style="text-align: left;">2.1 meters</td>
<td style="text-align: left;">Part 1 at time-0:35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wheel width</td>
<td style="text-align: left;">0.8 meters</td>
<td style="text-align: left;">same as flume</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bucket volume</td>
<td style="text-align: left;">48 liters</td>
<td style="text-align: left;">Part 1 at time-27:10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Buckets</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">Part 1 at time-19:50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flume length</td>
<td style="text-align: left;">8 meters</td>
<td style="text-align: left;">project survey document</td>
</tr>
<tr class="even">
<td style="text-align: left;">Flume drop</td>
<td style="text-align: left;">0.3 meters</td>
<td style="text-align: left;">project survey document</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flume width</td>
<td style="text-align: left;">0.8 meters</td>
<td style="text-align: left;">project survey document</td>
</tr>
<tr class="even">
<td style="text-align: left;">Flow rate</td>
<td style="text-align: left;">70 to 120 liters/sec</td>
<td style="text-align: left;">project survey document</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gear box</td>
<td style="text-align: left;">1:20 + 1:2 belt</td>
<td style="text-align: left;">total 1:40</td>
</tr>
<tr class="even">
<td style="text-align: left;">PM generator</td>
<td style="text-align: left;">2kW, 500 RPM</td>
<td style="text-align: left;">replaced with Induction generator</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Induction generator</td>
<td style="text-align: left;">2.2kw, 8 pole, 750 rpm</td>
<td style="text-align: left;">final video</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In part 4 of his video, Kris shared some details of his orginal project survey, <span class="citation" data-cites="Kris2023Survey">Harbour (<a href="#ref-Kris2023Survey" role="doc-biblioref">2023</a>)</span>. I captured images from the video and used google docs to convert the shreenshots to text. The project survey included an overview of the system, description of the proposed water wheel and two computer generated figures of the water wheel and surrounding site.</p>
<section id="scope" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="scope"><span class="header-section-number">1.1</span> Scope</h2>
<p>The analysis in this notebook will cover the project background as narrated by Kris in the videos. Calculations for the gravitational power of water are presented. A case study of two simular water wheel projects will be reviewed. The hydro system analysis will examine the design parameters. In my analysis, the electrical power generated will be delivered to an resistive load via a three phase, full wave rectifier. Kris was loading the generator with an inverter. I’m not addressing the grid connection. The generator is assumed to have a linear RPM to voltage curve over the water wheel operatating range of rotational rates. A review of the permanent magnet generator and some thermal calculations will be presented. Some discussions about the induction generator will presented, but a detailed analysis of a self excited induction generator will not be presented. Some comments and analysis of the flume are presnted. A few topics not covered in the videos are discussed, such as safety and maintenance. Finally, an economic analysis of the project is presented.</p>
</section>
<section id="review-of-videos" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="review-of-videos"><span class="header-section-number">1.2</span> Review of videos</h2>
<p>Each of the videos is about 40 minutes long. While watching, I took notes whenever he gave any technical details. The videos primarily document the build, installationa and some of the testing of the water wheel. The construction of the dam and flume were performed by friends and family. Most of the testing Kris did on site after installation. The exception was some open circuit testing of the first generator in his workshop, which at the time, he thought was adequate.</p>
<p><a href="https://www.youtube.com/watch?v=7l5xxIGiW7o">Powering An Old Mill - 1.5 Kw Lake District Overshot Waterwheel Project Part 1</a></p>
<ul>
<li>2.1m waterwheel, at time 0:16<br>
</li>
<li>150 lps max flow rate<br>
</li>
<li>50 liter buckets, three per second = 150 lps -&gt; 11.25 rpm<br>
</li>
<li>gear reduction 20:1, wheel will do 12 to 16 rpm<br>
</li>
<li>500 rpm 2kW, PM alternator<br>
</li>
<li>flow 150 liters/sec maximum<br>
</li>
<li>50 liter buckets<br>
</li>
<li>3 buckets will pass per second<br>
</li>
<li>1.5 to 1.7 kW<br>
</li>
<li>20:1 gear reduction<br>
</li>
<li>between 12 and 16 rpm depending on flow rate<br>
</li>
<li>500 rpm 2kW PM alternator &lt;- 25 rpm at the waterwheel shaft this seems in conflict<br>
</li>
<li>rpm of 16, rotation of 3.7 sec, 230 V from rectifer open circuit<br>
</li>
<li>16 buckets<br>
</li>
<li>42 L per bucket, measured 45 L</li>
</ul>
<p><a href="https://www.youtube.com/watch?v=PvgeSJKlNUs">Powering An Old Mill - 1.5 Kw Lake District Overshot Waterwheel Project Part 2</a></p>
<ul>
<li>at the site no dam or pond, just the leat</li>
<li>blocked the water, made some templates and models</li>
<li>flume = four boards across, walls are set internal and look a bit higher than the individual base boards are wide at time 1:57</li>
<li>work on the spill way</li>
<li>at time 10:16, cutting back the flume</li>
<li>at time 25:11, connected 3 conductors to bottom of the frame.</li>
<li>at time 30:22, 340 volts w/o load</li>
<li>at time 32:03, load test, maybe 1 inch of flow in the flume, buckets are less than half flow making 530 Watts, at time 33:08</li>
<li>increased flow, maybe 1 inch in the flume</li>
<li>at time 34:42, 2nd day of testing, rained overnight and lots of water flowing around the wheel.</li>
<li>at time 36:37, 2/3rd flow, flume water level looks at the top at the enterence, but just past the gate, the water level is a few inches, reduced to like 1/2 up the side boards, buckets are ??, power 940 Watts<br>
</li>
<li>at time 37:22, 3rd day, showing the conduet installed<br>
</li>
<li>complaning that the controller is letting the wheel spin too fast, but generating 1 kW</li>
<li>at time 40:16, add some plywood to control the water fill angle, took some slow motion video time-41:38.<br>
</li>
<li>at time 42:54, put the controller into constant voltage mode 100V an di splanning to up the voltage based on testing</li>
<li>wheel spinning much slower, buckets look 1/3 full at time 44:21</li>
<li>He thinks the alternator want to spin much faster, it will generate 1000 Watts, but the wheel is spinning too fast, when he uses the controller to slow the wheel for proper bucket filling the power is much less and the alternater got very hot.</li>
</ul>
<p><a href="https://www.youtube.com/watch?v=DInwut0DzTQ">Powering An Old Mill - 1.5 Kw Lake District Overshot Waterwheel Project Part 3</a></p>
<ul>
<li>got a bigger pulley, now the total ratio is 20x2=40</li>
<li>corner on the flume was improved<br>
</li>
<li>Kris built a nozzle for the water</li>
<li>at time 9:21, installed the new pulley and a new lower voltage alternater</li>
<li>at time 14:11, with flume nozzle buckets look like they are filling better, look about 1/2 full, generater is making 420 Watts<br>
</li>
<li>water flow from the main river down a man made leet,</li>
<li>at time 16:22, removed the boards that made a temporary dam and much more water is flowing, but the wheel is spinning too fast but making 1160 Watts, earlier 1400 Watts</li>
<li>2 KW alternater, but only can make 1400 Watts before it gets too hot.</li>
<li>at time 17:21, 810 Watts when flow rate reduced and wheel spinning at a near proper speed.</li>
<li>at time 18:33, next day, ran all night, making 750 Watts</li>
<li>at time 19:19, 600 rpm on the generator (15 rpm on the water wheel), measured with a Tach, generating Alt temp is 80C when generating 750 Watts (that 15 rpm on the wheel shaft)</li>
<li>at time22:46, 950 Watts is the most it can do before it gets too hot</li>
<li>test grid down dump load.</li>
<li>at time 34:41, took apart the 220 V alternator and the new one is a 96V alternator.</li>
<li>at time 42:30, new plan is to use an 8 pole induction motor at the generator</li>
</ul>
<p>Why did he change to a lower voltage alternater? Old alternater was making 420 volts, he wanted 220 volts.</p>
<p><a href="https://www.youtube.com/watch?v=WPICp3c_qIQ">Powering An Old Mill 1.5 Kw Lake District Overshot Waterwheel Project Part 4</a></p>
<ul>
<li>3 phase induction motor, 8 pole, 750 rpm, 2.2kW (needs a water wheel speed of 18.75 rpm)<br>
</li>
<li>motor face plate: Tec ECHTOP UK CA, Type 2283TECA 83<br>
</li>
<li>switched to a 2kW induction motor, 728rpm, 1711 Watts, 184 volts<br>
</li>
<li>testing of induction motor in John’s hydro electric workshop, drive motor was 3kW, 728rpm, 1711 Watts, 184 volts, 80uF caps<br>
</li>
<li>modifiling the frame and mounting brackets<br>
</li>
<li>looks like a cooling fan on the back of the motor, water side.<br>
</li>
<li>added emergency shut off flap<br>
</li>
<li>dump load mounted on wall in poarch, 1.5 kW load<br>
</li>
<li>half flow test made 860W<br>
</li>
<li>full flow entrance to flume is at the top of the walls, but within everal inches the depth is 1/2, at the end of the flume, depth looks loke 1 inch,<br>
</li>
<li>full flow, water is impacking into the buckets with substantial splash over, generating about 1.6kW, splasing on the generator cover, at the 4 to 5 oclock postion, water sloshing out of the buckets, buckest are 2/3s full, making 1350 Watts<br>
</li>
<li>added plywood to block water exit from the leat in order to increase the flow<br>
</li>
<li>flow in the flume looks a bit larger, maybe 2 inches deep at the exit, pitch on the flume looks like a couple of inches, velocity is high, lots of spash over, making 1500 to 1550 Watts, promised the customer 1500 Watts - not a qualified electrician, only doing the mechanicans and making electricity.</li>
<li>changing the caps to smaller value<br>
</li>
<li>with some reduced flow, getting 1150 Watts, but less splashing,<br>
</li>
<li>at time 22.33, Project Survey from <span class="citation" data-cites="Kris2023Survey">Harbour (<a href="#ref-Kris2023Survey" role="doc-biblioref">2023</a>)</span>.</li>
<li>added a rpm sensor to run a safety shut off<br>
</li>
<li>at time 29:41, with minimal splasing generates about 500 Watts<br>
</li>
<li>testing with gride off, power dumped into load, resistors shown at 50C</li>
</ul>
<p><a href="https://www.youtube.com/watch?v=RWTgMWRc2W4">Powering An Old Mill 1.5 Kw Lake District Overshot Waterwheel Project Part 5</a></p>
<ul>
<li>designed an over speed controller</li>
<li>water wheel broke and being invesigated, cracked hub on one side, welded back up.</li>
<li>changed to dual V-belts from reduction gear box to generator because of allighment issues. Then the wheel was moving slower and after a few days the end plate on the wheel hub cracked.</li>
<li>V-belt pulley diameters look about the same as the old 2:1</li>
<li>at time 9:44, RPM sensor set to 18 RPM</li>
<li>at time 10:50, water wheen running, some water being spashed out of the buckets, substantial amounnt of water in the spillway, Kris says the generator is makeing 1kW.</li>
<li>Kris make a few comment at the end about amount of water flow, but in the video there is lots of water flowing in the spillway, which is at odds with his comment later.</li>
<li>at time 13:07 Kris showed the cloud data from the inverter, capacity set to 1.6kW, generator makeing 0.78kW (54.3%).Today made 9kWh for a earning of 2.52GBP. Total yeild reported on that day was 479kWh for earning of 134.12 GBP. Dates on the app display show months of Nov and Dec.</li>
<li>Kris claims one of the reasons he’s not too concerned about the excessive splashing is because that flow rate is not representative over most of the year, like mid-winter at the time of recording. But this contradics the stated goal of making 1.5kW and impacts the ROI.</li>
<li>Kris says this is the last video in the seires</li>
</ul>
</section>
<section id="units" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="units"><span class="header-section-number">1.3</span> Units</h2>
<p>In the calculations that follow, I’m using the Python package, <a href="https://pint.readthedocs.io/en/0.19/index.html">Pint</a>, which allows mathematical operations with units and conversions to and from different units. Keeping track of the units will provide some error checking when performing the calculations. I’ll be using metric units since this is what Kris has been using. All calculations are done using the International System of units. A list of units and conversions used by Pint is <a href="https://github.com/hgrecco/pint/blob/master/pint/default_en.txt">here</a>.</p>
</section>
<section id="variables-and-constants" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="variables-and-constants"><span class="header-section-number">1.4</span> Variables and constants</h2>
<p>There are a couple of variables and constants that will be used throughout the calculations.</p>
<ul>
<li>Q is used for flow rate, in this notebook, liters per second<br>
</li>
<li>tau or <span class="math inline">\(\tau\)</span> is used for torque</li>
<li>g is used to denote the gravity of <a href="https://en.wikipedia.org/wiki/Gravity_of_Earth">Earth</a>, standard gravity by definition is equal to 9.80665 <span class="math inline">\(m/s^2\)</span></li>
<li>rho or <span class="math inline">\(\rho\)</span> is used for the <a href="https://www.turito.com/blog/one-on-one-online-tutoring/what-is-the-density-of-water">density of water</a>, at 50F or 10C is 999.75 <span class="math inline">\(kg/m^3\)</span></li>
<li>eta or <span class="math inline">\(\eta\)</span> is used for energy conversion efficiency, accounts for the energy lost to heat</li>
</ul>
</section>
<section id="python-package-versions" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="python-package-versions"><span class="header-section-number">1.5</span> Python package versions</h2>
<p>The versions used at the time of writting this notebook are listed in <a href="#tbl-python-version" class="quarto-xref">Table&nbsp;2</a>.</p>
<div id="tbl-python-version" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-python-version-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Python package versions
</figcaption>
<div aria-describedby="tbl-python-version-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<tbody>
<tr class="odd">
<td><a href="https://pypi.org/project/tabulate/">tabulate</a></td>
<td>0.8.10</td>
</tr>
<tr class="even">
<td><a href="https://www.python.org/">Python</a></td>
<td>3.10.9</td>
</tr>
<tr class="odd">
<td><a href="https://numpy.org/">NumPy</a></td>
<td>1.23.5</td>
</tr>
<tr class="even">
<td><a href="https://matplotlib.org/">Matplotlib</a></td>
<td>3.7.0</td>
</tr>
<tr class="odd">
<td><a href="https://ipython.org/">IPython</a></td>
<td>8.10.0</td>
</tr>
<tr class="even">
<td><a href="https://pint.readthedocs.io/en/stable/">Pint</a></td>
<td>0.22</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="terminology" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="terminology"><span class="header-section-number">1.6</span> Terminology</h2>
<p>Kris uses the term ‘trough’ for the structure that carries the water to the top of the water wheel; I’ll be using the term <a href="https://en.wikipedia.org/wiki/Flume">Flume</a> to describe the structure.</p>
<p>Other terms are:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Mill_race">Mill race</a><br>
</li>
<li><a href="https://en.wikipedia.org/wiki/Mill_pond">Mill pond</a><br>
</li>
<li><a href="https://en.wikipedia.org/wiki/Leat">Leat</a><br>
</li>
<li><a href="https://en.wikipedia.org/wiki/Sluice">Sluice</a><br>
</li>
<li><a href="https://en.wikipedia.org/wiki/Weir">Weir</a><br>
</li>
<li><a href="https://en.wikipedia.org/wiki/Pico_hydro">Pico hydro</a></li>
<li><a href="https://en.wikipedia.org/wiki/Grid-tied_electrical_system">Grid-tied electrical system</a></li>
</ul>
</section>
</section>
<section id="gravitational-power-of-water" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Gravitational power of water</h1>
<p>Harvesting the gravitational energy of water is a proven source of energy, also known as <a href="https://en.wikipedia.org/wiki/Hydropower">hydropower</a>. Since a waterwheel is used to extract power from the water, the head height is approximately the diameter of the waterwheel. Water enters at the top of the wheel and the weight of the water causes the wheel to rotate until a point near the bottom of the wheel.</p>
<p>To calculate the power, we can use the formula provided in Wikipedia, <a href="https://en.wikipedia.org/wiki/Hydropower">Calculating the amount of available power</a>. The gravitational power of water is given by:</p>
<p><span class="math inline">\(P = \eta \rho g Q H\)</span></p>
<p>where:<br>
P = gravitational power of water<br>
<span class="math inline">\(\eta\)</span> = (eta) is the efficiency of the turbine<br>
<span class="math inline">\(\rho\)</span> = (rho) density of water<br>
g = acceleration due to gravity<br>
Q = flow rate<br>
H = height that the water travels</p>
<p>Q is the volumetric flow rate of water and the SI units are cubic meters per second. In this notebook, I’ll be using liters per second and the Python library will handle the conversion of liters per second to Pint’s base units for calculations. One cubic meter per second equals 1000 liters per second.</p>
<section id="verifying-kriss-estimated-power-versus-flow-rate" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="verifying-kriss-estimated-power-versus-flow-rate"><span class="header-section-number">2.1</span> Verifying Kris’s estimated power versus flow rate</h2>
<p>In <span class="citation" data-cites="Kris2023Survey">Harbour (<a href="#ref-Kris2023Survey" role="doc-biblioref">2023</a>)</span>, Kris provided his customer an estimated of the power that might be generated versus flow rates. Kris used H = 2.6 meters and <span class="math inline">\(\eta\)</span> = 0.6. <a href="#tbl-kris-pwr" class="quarto-xref">Table&nbsp;3</a> shows Kris’s the power versus flow rate.</p>
<div id="tbl-kris-pwr" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kris-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Kris’s estimated power, head = 2.6 meters, <span class="math inline">\(\eta\)</span> = 60%
</figcaption>
<div aria-describedby="tbl-kris-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Flow rate</th>
<th>Power, Watts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>60 lps</td>
<td>833</td>
</tr>
<tr class="even">
<td>70 lps</td>
<td>1,030</td>
</tr>
<tr class="odd">
<td>80 lps</td>
<td>1,177</td>
</tr>
<tr class="even">
<td>90 lps</td>
<td>1,324</td>
</tr>
<tr class="odd">
<td>100 lps</td>
<td>1,472</td>
</tr>
<tr class="even">
<td>110 lps</td>
<td>1,619</td>
</tr>
<tr class="odd">
<td>116 lps</td>
<td>1,692</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The following code plots Kris’s estimated power as red x’s and the power using Wikipedia’s formula as the black solid line. As shown in <a href="#fig-survey-grav-pwr" class="quarto-xref">Figure&nbsp;2</a>, there is a difference between Kris’s numbers and those obtained using the Wikipedia equation.</p>
<div id="cell-fig-survey-grav-pwr" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-survey-grav-pwr" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-survey-grav-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-survey-grav-pwr-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-survey-grav-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Kris’s estimated power versus flow rate calculations
</figcaption>
</figure>
</div>
</div>
</div>
<p>At 60 l/s the difference is greater than for the other points. From 70 to 110 l/s, the differece is constant, with a difference of about 3.8%. At 116 l/p, the difference is about 4.6%. I’m not sure why Kris’s numbers differe from the Wikipedia equation. Perhaps he was using different values for H at the various flow rates. Also, it seems courious that the final number in his table is 116 lps and not 120 lps. Additionally, I think he should be using the diameter of the wheel as the head height in his calculations.</p>
</section>
</section>
<section id="case-studies" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Case studies</h1>
<p>The history of <a href="https://en.wikipedia.org/wiki/Water_wheel">water wheels</a> dates back thousands of years and the <a href="https://www.british-hydro.org/waterwheels/">fundementals</a> of water wheels are well understood. What is new is the restoration of historic water mills being employed to generate electricity. Water wheels have a low rotational speed with high torque and this equires the use of gears to step up the rotational speed to a level that can be used by electrical generators. I found two intreseting examples of small water wheels being used to generate electrical power. In each of these examples, we can calculate the overall efficiency. This is a useful data point since these water wheels are of simular size to the one Kris built.</p>
<p><strong><a href="https://www.youtube.com/watch?v=NVs9EDzez0o">Eskdale Mill</a></strong><br>
The Eskdale Mill is profiled in the YouTube video (link above). <a href="https://www.smith-eng.co.uk/">Smith Engineering</a> performed the design of the water wheel. The wheel is installed at the oldest and last working corn mill in the English Lake District, providing power for the miller’s cottage. It has been positioned adjacent to the Grade II* listed mill which has been operating for hundreds of years.</p>
<div id="tbl-Eskdale-Mill" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Eskdale-Mill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Eskdale Mill, miller’s cottage water wheel summary
</figcaption>
<div aria-describedby="tbl-Eskdale-Mill-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Location</td>
<td>Boot, Eskdale Valley, Cumbria, England</td>
</tr>
<tr class="even">
<td>Commissioned</td>
<td>July 2016</td>
</tr>
<tr class="odd">
<td>Output</td>
<td>3.5 kW</td>
</tr>
<tr class="even">
<td>Flow rate</td>
<td>120 l/s</td>
</tr>
<tr class="odd">
<td>Wheel diameter</td>
<td>4.0 m</td>
</tr>
<tr class="even">
<td>Wheel width</td>
<td>0.8 m</td>
</tr>
<tr class="odd">
<td>Gearbox</td>
<td>Brevini epicyclic</td>
</tr>
<tr class="even">
<td>Generator</td>
<td>Brook Crompton three-phase, 415V induction motor converted to single-phase 240V</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!--
#| echo: false
H = 4*ureg.meter # diameter of the wheel, used as the head height
Q = 120*ureg.liter/(1*ureg.sec)
print('available power: {:,.1fP}'.format((rho*g*Q*H).to('watts')))
print('efficiency: {:,.2f}%'.format(((3500*ureg.W)/(rho*g*Q*H).to('watts')).magnitude*100))
-->
<div id="cell-9" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="4">
<p>The Eskdale Mill’s water wheel has 4,706 watts of power available from the head. The output from the generator is 3.5kW, which calculates to an efficiency of 74.4%. The diameter of the Eskdale Mill’s water wheel is about twice the diameter of Kris’s and generates more than twice the power. The flow rate at the Eskdale Mill is 120 lps, which is near the upper range of what Kris expects his flow rate to be. The Eskdale Mill uses an induction motor driven by a Brevini epicyclic gearbox.</p>
</div>
</div>
<p><strong><a href="https://www.youtube.com/watch?v=x9VpPcSS47Q&amp;t=2s">The Langdale Hotel and Spa, English Lake District</a></strong><br>
This water wheel was also build by Smith Engineering and based on research and development that Smith Engineering had undertaken with Dr Paddy Quinlan of the University of Cumbria on bucket design and efficiency. There is a high degree fo simularity in the look of this water wheel to the one that Kris built.</p>
<div id="tbl-Langdale-Hotel" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Langdale-Hotel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: The Langdale Hotel and Spa water sheel summary
</figcaption>
<div aria-describedby="tbl-Langdale-Hotel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Location</td>
<td>Great Langdale, Cumbria, England</td>
</tr>
<tr class="even">
<td>Commissioned</td>
<td>November 2014</td>
</tr>
<tr class="odd">
<td>Output</td>
<td>6 kW</td>
</tr>
<tr class="even">
<td>Flow rate</td>
<td>200 l/s</td>
</tr>
<tr class="odd">
<td>Wheel diameter</td>
<td>4.1 m</td>
</tr>
<tr class="even">
<td>Wheel width</td>
<td>1 m</td>
</tr>
<tr class="odd">
<td>Gearbox</td>
<td>Brevini epicyclic 177:1 ratio</td>
</tr>
<tr class="even">
<td>Generator</td>
<td>Brook Crompton three-phase, 415V induction motor, power rating of 11kW</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!--
#| echo: false
H = 4.1*ureg.meter
Q = 200*ureg.liter/(1*ureg.sec)
(rho*g*Q*H).to('watts')
print('available power: {:,.1fP}'.format((rho*g*Q*H).to('watts')))
print('efficiency: {:,.2f}%'.format(((6000*ureg.W)/(rho*g*Q*H).to('watts')).magnitude*100))
print('generator rated power to avaliable power: {:,.2f}'.format(((11000*ureg.W)/(rho*g*Q*H).to('watts')).magnitude))
-->
<div id="cell-12" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="5">
<p>The Langdale water wheel has 8,039 watts of power available from the head. The output from the generator is 6kW, which calculates to an efficiency of 74.6%. The diameter of the Langdale’s water wheel is about twice the diameter of Kris’s, but a little wider and generates more than four times the power. The Langdale Hotel’s water wheel also uses an induction motor as the generator with a 177:1 Brevini epicyclic gear box. If the water wheel has a rotational rate of 10 RPM, then generator shaft rotation would be 1770 RPM. The generator output is less than the rated power with a de-rating of 55%.</p>
</div>
</div>
<p>Links to other water wheel videos:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=wAV4d6WHo70">Hydro electric water wheel with generator in Egloffstein</a>: A hydro-electric water wheel in Egloffstein Franconia with 12kW Generator.<br>
</li>
<li><a href="https://www.youtube.com/watch?v=7l9t_t8ES-Q">Stunning Franconia Aerial #6 Hydro electric water wheel in Egloffstein</a>; The camera is flying over a hydro-electric water wheel in Egloffstein, Franconia (Germany).<br>
</li>
<li><a href="https://www.youtube.com/watch?v=KufodXxwCfg">Two views of the 1926 Fitz overshot waterwheel at Hanford Mills Museum</a>: Two views of the 1926 Fitz Overshot waterwheel in operation at Hanford Mills Museum in East Meredith, NY. The power generated is used to run the sawmill and woodworking machines. The first view is from the visitor platform, and the second is from the tail race. The 10-foot diameter waterwheel is 12 feet wide. A system of belts, pulleys and gears transfers the power to machines upstairs in the Mill.<br>
</li>
<li><a href="https://www.youtube.com/watch?v=R4f_xgx7yQ0">Waterwheel power 4kW to grid</a>: We re-purposed this 140 year old wheel to generate and export power back to the grid in 2007/8. 10 years on and its made well over 100,000kWh energy, most of it exported .. generation matches flow availability, we could process more but the axles at its limit and the wheel floods .. efficiency is very high, the gearbox and generator silent, its a capacitor excited induction generator with integral flow management and grid tie cabinet. The system hinges around the ponds water level, the original wheel control sluice is reused. This is a beautifully engineered large wheel running well within its capabilities, the iron structure is much more than functional, a look in detail shows considerable artisan and design skills … we believe this is the largest wheel on a domestic property in UK Update 2019/20: still working really, really well. New owner, Francis, has addressed a number of site issues and runs at full rated power most of the time. we’re well on the way to the first 500,000 kWh energy production.<br>
</li>
<li><a href="https://www.youtube.com/watch?v=p53yPXfZLE8">Water wheel - Energy Power Generator - Construction KIT</a>: Water wheel - Upper bucket - Building kit. We offer a complete building kit or just drawings for the CNC production of a water wheel type - Upper bucket. The material for production is stainless steel or ordinary steel. It is possible to change the dimensions as required. The water wheel is a suitable water engine for all historic buildings, such as a power plant or as decoration. At reduced speeds, it can process many times smaller flows than expected, without a decrease in efficiency.</li>
</ul>
<p>Key takeaways:</p>
<ul>
<li>In most cases, the water velocity in the flume is lower than in Kris’s flume and there is not a lot of splashing as the buckets are bing filled.<br>
</li>
<li>The rated power of the generator is useally higher than the avaliable power. I think the size of the generator needs to have some de-rating applied. If the water wheel Kris was building was capable of producing 1500 Watts, the generator should be rated for someting like 2000 Watts of continious operation.</li>
<li>The size of these systems are more than twice the size of the system Kris is building, perhaps indicating the economics is more favarable for a larger water wheel.</li>
</ul>
</section>
<section id="hydro-system-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Hydro system analysis</h1>
<!--
#| echo: false
number_of_buckets = 16/(1*ureg.circle)
wheel_width = 0.8*ureg.meter
bucket_volume = 48*ureg.liter
water_wheel_diameter = 2.1*ureg.meter
bucket_capacity_utilization = 0.95
-->
<div id="cell-15" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="6">
<p>The analysis will consist of looking at the performance of the water wheel based on the information avaliable from Kris’s YouTube videos. In the calculations that follow, the water wheel diameter is 2.1 meters with a width of 800 millimeters. The number of buckets on the wheel is 16 / turn and the bucket volumne is 48 liters. In the first iteration of the design Kris had a gear ratio of 1:20 and later he increased the ratio to 1:40. The generator that Kris used initially was a perminate magnet generator rated for 2,000 Watts at 500 RPM.</p>
</div>
</div>
<p>The control of the water into the leat which feeds the mill pond appears to be unregulated and roughly controlled by a rock wier and wooden planks. The flow of water in the flume and spillway is set by stacking boards boards to damn the water to the desired level. With this manually set arrangement, there is no flow control and the hydo system runs open loop; other than the over speed shutoff. The maximum flow in the flume is set by the spill way height. This means that the load on the waterwheel and rotational rate is determined the the inverter.</p>
<!--
#| echo: false
H = 2.1*ureg.meter # head equal to the wheel diameter
#print('head height: {:.1f#~P}'.format(H))
-->
<p>Kris use an overall efficieny of 60% in his calculations. I’ve decided to break out the efficiencies of the major components and then calculate an overall efficiency.</p>
<section id="efficiencies" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="efficiencies"><span class="header-section-number">4.1</span> Efficiencies</h2>
<p>A typical overshot <a href="https://en.wikipedia.org/wiki/Water_wheel">Water wheel</a> has the water channeled to the wheel at the top and slightly beyond the axle. The water collects in the buckets on that side of the wheel, making it heavier than the other “empty” side. The weight turns the wheel and the water flows out into the tail-water when the wheel rotates enough to invert the buckets. The overshot design can achieve 90% efficiency. Nearly all of the energy is gained from the weight of water lowered to the tailrace although a small contribution may be made by the kinetic energy of the water entering the wheel.</p>
<p>The efficiencies I’ll be using in my calculations:</p>
<ul>
<li><span class="math inline">\(\eta\)</span> for waterwheel = 90%<br>
</li>
<li><span class="math inline">\(\eta\)</span> for gear box = 95%<br>
</li>
<li><span class="math inline">\(\eta\)</span> for generator = 90%</li>
<li><span class="math inline">\(\eta\)</span> for grid-tie inverter = 97%</li>
</ul>
<div id="cell-19" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="7">
<p>These effencienies have been adjusted to give an overall efficiency in line with what has been acheived in the case studies. The total system efficiency used in the analysis is 74.6%</p>
</div>
</div>
<!--
eta_waterwheel = 0.9 # for a small waterwheel
eta_gear_box = 0.95
eta_generator = 0.9
eta_grid_tie_inverter = 0.97
eta_total = eta_waterwheel*eta_gear_box*eta_generator*eta_grid_tie_inverter
print('total efficiency: {:.3f}'.format(eta_total))
-->
</section>
<section id="design-parameters" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="design-parameters"><span class="header-section-number">4.2</span> Design parameters</h2>
<p>In the YouTube video and the project survey, Kris stated that the veritcal height that was available down stream from the dam would allow for a 2.1 meter diameter water wheel with some room clearace above and below. The flume would need to be about 8 meters long. The flow rate avalailbe ranged from 60 to 120 liters per second (lps or l/s) and that the goal was to generate 1,500 Watts, presummably at 120 lps. Most of the technical parameters have been summarized in <a href="#tbl-tech-parm" class="quarto-xref">Table&nbsp;1</a>. The important paramters for the analysis of the hydro system are the wheel diameter and the water flow rate.</p>
<p>The water source for the project is a river that runs adjacent to the property from which a leat diverts a small portion of water to the mill pond. The leat, mill pond as mentioned in the videos were constructed some time ago and the dam had been removed. The range of flow rates from the leat and out of the mill pond was estimated to be in the range of 60 to 116 lps. Kris was hoping to produce 1500 Watts from about 110 lps.</p>
<p>In the calculations that follow, I’m using a range of flow rates from 60 to 120 lps and a total efficiency of 75% as discussed above. I’ve decided to include a design margin of <span class="math inline">\(\theta\)</span> = 15% in the power estimate calculation to account for unknowns and/or poor estimates.</p>
<p>The gravitation power of water at various flow rates is plotted in <a href="#fig-grav-pwr" class="quarto-xref">Figure&nbsp;3</a>. As discussed avove, the head height is 2.1 meters since this is the distance water moves as it is carried by the water wheel’s buckets from the 12 o’clock position to the botton at the 6 o’clock position. The shaded area is the expected nornal variation in flow rate, 60 lps to 120 lps.</p>
<div id="cell-fig-grav-pwr" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div id="fig-grav-pwr" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grav-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-grav-pwr-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grav-pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Estimated power production for a head of 2.1 m at various flow rates
</figcaption>
</figure>
</div>
</div>
</div>
<p>The estimated power production ranges from just below 800 Watts at 60 lps to just almost 1600 Watts at 120 lps. The ability of the hydro system to produce electrical power at these levels is dependednt on a properly designed system operating at the efficiencies discussed above. The included design margin of 15% provides some wiggle room. In <a href="#tbl-kris-pwr" class="quarto-xref">Table&nbsp;3</a>, Kris thought 1500 Watts could be produced with a flow rate between 100 and 110 lps. However, <a href="#fig-grav-pwr" class="quarto-xref">Figure&nbsp;3</a>, shows that a flow rate of about 115 lps is needed to make 1500 Watts.</p>
<!--
$\large{\color {red} {\text{think about deleting this table}}}$  

#| label: tbl-grav-pwr
#| echo: false
#| tbl-cap: Gravitational power of water for a head of 2.1 m at various flow rates

print('head height: {:.1fP}, \u03B7: {:.1f}, \u03b8: {:.0f}%'.format(H,eta,theta*100))
table_header = ['Flow rate, l/s', 'Power, Watts']
table_row = []

for i in Q:
    table_row.append([i.to('l/s').magnitude,(rho*g*i*H*eta_total*(1-theta)).to('watts').magnitude])

Markdown(tabulate(table_row, headers=table_header,colalign = ('left','left'),tablefmt="simple",floatfmt=('.0f',',.1f')))
-->
<div id="cell-25" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="9">
<p>With a flow rate range of 40 l/s to 180 l/s, the estimated power avaliable is 522.5 W to 2351.3 W, so it appears that making 1300 W at 110 lps and 1500 W at 120 lps is feasable.</p>
</div>
</div>
</section>
<section id="instrumentation" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="instrumentation"><span class="header-section-number">4.3</span> Instrumentation</h2>
<p>Kris utilized only a volt meter and relied on the inverter to provide him an indication of the power being generated. For testing, he should have used a resistive load, a volt meter (which he did use) and an amp meter. He could have used the dump load across the three phase recitfier. This would have eliminated any setup issues with the inverter.</p>
<p>Other instrumentation which would have been helpful to have for testing and set up of the system:</p>
<ul>
<li>water wheel rotation rate</li>
<li>generator frequency</li>
<li>mill pond surface level</li>
<li>web cam on water wheel, mill pond etc. for remote monitoring</li>
<li>inverter status</li>
</ul>
<section id="inverter" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="inverter"><span class="header-section-number">4.3.1</span> Inverter</h3>
<p>In the videos, Kris uses a <a href="https://www.solisinverters.com/uploads/file/Solis_Manual_S6-GR1P(2,5-6)K_FN_EUR_V1.2(20221116).pdf">Solis S6 Series</a> single phase <a href="https://en.wikipedia.org/wiki/Power_inverter">inverter</a> to convert the DC voltage from the rectifier block to AC. He was not clear how the inverter was connected or what the load was during testing. <a href="#tbl-solis-inv" class="quarto-xref">Table&nbsp;6</a> provides a summary of the specifications for the 2.5kW inverter.</p>
<div id="tbl-solis-inv" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-solis-inv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Specifications for Solis 2.5kW S6 Series
</figcaption>
<div aria-describedby="tbl-solis-inv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Model</td>
<td>S6-GR1P2.5K</td>
</tr>
<tr class="even">
<td>Max. DC input voltage (Volts)</td>
<td>550</td>
</tr>
<tr class="odd">
<td>Rated DC voltage (Volts)</td>
<td>250</td>
</tr>
<tr class="even">
<td>Startup voltage (Volts)</td>
<td>60</td>
</tr>
<tr class="odd">
<td>MPPT voltage range (Volts)</td>
<td>50 to 450</td>
</tr>
<tr class="even">
<td>Max. input current (Amps)</td>
<td>14+14</td>
</tr>
<tr class="odd">
<td>Rated output power (Watts)</td>
<td>2500</td>
</tr>
<tr class="even">
<td>Rated grid voltage (Volts)</td>
<td>1/N/PE, 220/230</td>
</tr>
<tr class="odd">
<td>Rated output current (Amps)</td>
<td>11.4/10.9</td>
</tr>
<tr class="even">
<td>Max. output current (Amps)</td>
<td>13.3</td>
</tr>
<tr class="odd">
<td>Power Factor (at rated output power)</td>
<td>&gt; 0.99 (0.8 leading - 0.8 lagging)</td>
</tr>
<tr class="even">
<td>THDi (at rated output power)</td>
<td>&lt;3%</td>
</tr>
<tr class="odd">
<td>Rated grid frequency (Hertz)</td>
<td>50/60</td>
</tr>
<tr class="even">
<td>Operating frequency range (Hertz)</td>
<td>45 to 55 or 55 to 65</td>
</tr>
<tr class="odd">
<td>Max.efficiency</td>
<td>97.3%</td>
</tr>
<tr class="even">
<td>EU efficiency</td>
<td>96.5%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Kris was able to control the speed of the wheel by changing the mode to constant voltage mode and setting the value to 100 volts. This casued the generator to get smoking hot under full flow conditions. About this time he started to suspect that the rating of the generator was much less than indicated on the face plate of the generator. But the situation is a little confusing. I suspect that the availavle power was much greater than the power indicated on the inverter display, so the difference was being dissipated as heat in the generator, since the generator was being forced to provide a breaking load to the water wheel. This is why using a fixed power resistor as the load would have been much better for inital testing.</p>
<p>There are a couple things to keep in mind.</p>
<ul>
<li>The maximum DC input voltage is 550 Volts, so some determination would need to be made if a free spinning water wheel could under any conditions, normal or abnoramal, cause the generator to produce a voltage in excess of this limit. If there is a chance, then some sort of over voltage protection is needed. Earily in the video series, Kris did check the open circuit voltage out of the rectifier and a high flow rate an measured 350 Volts, but this was hardly a comprhensive analysis of the maximum possible voltage.</li>
<li>The operating mode of the Solis S6 Series needs to be investigated, because it’s not clear to me that a MMP mode is optimum for a small hydro system running open loop.</li>
</ul>
</section>
<section id="electrical-load-for-analysis-and-testing" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="electrical-load-for-analysis-and-testing"><span class="header-section-number">4.3.2</span> Electrical load for analysis and testing</h3>
<p>In the videos, Kris was using inverter as the electrical load for the generator. I think he should have been using a high power resistive load for his inital tests. Three portable electric heaters or his dump load could have been used for testing. Once everything was sorted out, he could then connect to the Solis S6 Series inverter for additional tests.</p>
<p>To calculate the load resistance for my analysis, I’m assuming that 1500 Watts is the load he should be using; I’m assuming the geneator makes 220 volts line to line, at the rated power, at 500 RPM.</p>
<p>The generator is connected to rectifier block. Kris didn’t say too much about the rectifier, so I’ll assume that it is a three phase full wave rectifier with six diodes being used to convert the three phase alternating current to direct current.</p>
<p>The voltage across the positive and negative terminals of the recitfier block is calculated from the generator output line to line voltage by the following:</p>
<p><span class="math inline">\(V_{load(DC)} = \frac{3\sqrt{2}}{\pi} V_{generator L-L(RMS)}\)</span></p>
<p>This equation is described in the Wikipedia article, <a href="https://en.wikipedia.org/wiki/Rectifier">Three-phase bridge rectifier uncontrolled</a>. The Wikipedia derivation uses line to netural, whereas I’m using line to line, so that’s why my equation is a written differently than in the article.</p>
<div id="cell-27" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="10">
<p>Rearranging the relation: <span class="math inline">\(P=V^2/R\)</span>, we can calculate the value of the resistor needed to dissapate 1500 Watts at voltage developed by 500 RPM on the generator shaft. A load resistance of 58.8 Ω will provide the required load</p>
</div>
</div>
<!--
#| echo: false
R_load = (220*ureg.volt*3*np.sqrt(2)/np.pi)**2/(1500*ureg.watt)
R_load.ito('ohm')
Markdown('Load resistor: {:.1f~P}'.format(R_load))

based on Vdc out of the rectifier, calculate the power. Kind of not correct because open circuit voltage is not the same as under load.

# solving for V_line_line given V_load
#V_load = V_line_line_rms*3*np.sqrt(2)/np.pi
V_load = 230
V_line_line_rms = V_load/(3*np.sqrt(2)/np.pi)
V_line_line_rms

# calculate the power at this V_line_line
(2000/240)*V_line_line_rms
-->
</section>
</section>
<section id="gear-box" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="gear-box"><span class="header-section-number">4.4</span> Gear box</h2>
<p>A gear box is required to convert the relatively low rotational speed of the water wheel to a higher rotational speed required for the generator. Kris is using a combination of a reduction box driven from the low end to step up the RPM by 20. Later he added a larger pulley to provide an addition step up in RPM of 2; this is a total RPM step up of 40.</p>
</section>
<section id="generator-and-rectifier-voltage" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="generator-and-rectifier-voltage"><span class="header-section-number">4.5</span> Generator and rectifier voltage</h2>
<p>I’m going to assum that the generator’s output voltage is linear with respect to the generator shaft rotational speed (at least over the expected operating RPM range, some where near the water wheel rotational speed of 10 RPM). In the videos, Kris used several generators and he usually measured the generator voltage at the output recifier. The first generator appears to have a rated voltage of 220 Volts line to line. Later this generator was swapped out for one with a lower voltage rating of 96 Volts. In the final video, Kris changes the generator to a self excied induction generator.</p>
<p>From my recolection, Kris allways measures the voltage at the recitfier’s DC terminals.</p>
<p>In the first video Kris measured 230 Volts out of the recitfier when he was spining the wheel in his shop at what estimated was the proper speed. I’m wondering if he was spinning to get 230 volts and calling that the proper speed? In the second video he measured 240 volts when the wheel was free spinning.</p>
<ul>
<li>Kris didn’t explain why he changed from 220 to 96 volts except to say he was concerned that the wheel was spinning too fast.</li>
<li>The initial design had the 220 Volt generator, so that’s what I’m going with for the initial part of the analysis, later I’ll address the generator questions.</li>
</ul>
<p>The plot below shows the line to line generator voltage vs water wheel RPM, assuming a gear box of 40:1. The genertor needs 500 shaft RPM to make 220 volts at the rated power. One of the issues with Kris’s design is the gear ratio is too low. I think the ratio needs to be more like 1:60 to keep the water wheel RPM in the optimal range.</p>
<div id="cell-fig-rpm2volts" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div id="fig-rpm2volts" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rpm2volts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-rpm2volts-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rpm2volts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: generator output voltage vs water wheel RPM
</figcaption>
</figure>
</div>
</div>
</div>
<p>A water wheel rotational speed of 6 to 12 RPM is expected to be the optium range of the wheel rotation, which is highlighted in the plot above. The optimum range is based on the expected seasonal flow rates ranging from 60 lps to 120 lps and the tangential velocity of the wheel matching the water velocity in the flume. As describe above, the hydro system’s flow rate is not regulated, so there will be a range of flows that the water wheel is expected to encounter.</p>
<p>As shown in <a href="#fig-rpm2volts" class="quarto-xref">Figure&nbsp;4</a>, the line to line output of the generator is a function of the water wheel rotational speed. For this analysis we are assuming that the relationship is linear over this range. For a permanent magnet generator, this is usally the case, and typically a generator’s performance curve will show a high degree of linearity over the middile part of the RPM range. Later in the project Kris changed generators, as described below, to an induction generator running in a self excited configuration. An induction generator, while being a valid and reasonable option, requires a different set of assumtpings for the analysis, since self excited induction generators have poor voltage regulation. Which means that after the induction generator’s voltage climes to a voltage near the operating voltage during startup and the ‘system’ applies a load, the voltage will drop by a significant amount.</p>
<!--
Is the table below needed?  


table_header = ['wheel rpm', 'generator L-L, Vrms','rectifier Vdc','Pwr dissapated by Rload, W']
table_row = []

for i in water_wheel_rotation_frequency:
    V_line_line_rms = (gen_volt2rpm*ureg.volt)*i.magnitude*gear_box
    V_load = V_line_line_rms*3*np.sqrt(2)/np.pi
    table_row.append([i.to('rpm').magnitude,V_line_line_rms.magnitude,V_load.magnitude,(V_load**2/R_load).to('watts').magnitude])

Markdown(tabulate(table_row, headers=table_header,colalign = ('left','left','left','left'),tablefmt="simple",floatfmt=('.0f',',.1f',',.1f','.1f')))

print(tabulate(table_row, headers=table_header,colalign = ('left','left','left','left'),tablefmt="simple",floatfmt=('.0f',',.1f',',.1f','.1f')))

-->
<p>Later, I’ll look at power flow through the hydo system. Power from gravity on the mass of the water, to the rotational power of the wheel (RPM x torque), to the genrator and finally to the electrical test load. Accounting for losses along the way, the power delivered to the electrical load should be equal to the rotational power of the wheel minus the losses.</p>
</section>
<section id="water-wheel" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="water-wheel"><span class="header-section-number">4.6</span> Water wheel</h2>
<p>The water wheel the Kris designed and fabricated has a diameter of 2.1 meters, 16 buckets, each with a capacity of 48 liters and the wheel width is 0.8 meters. In the calculations that follow, I’m assuming the wheel will have a rotational frequency of between 5 to 15 rotations per minute (rpm). The electrical load on the generator will limit the rotational frequency of the water wheel by resisting the torque delivered to the generator shaft. The electrical load is provided by the inverter. Through out the calculations that follow, I’m assuming that the wheel rotation frequency will be limited by the electrical load placed on the generator by the inverter. If the wheel is making 1000 Watts and delivering this power to the generator shaft, it is assumed that the generator will extract the power at an RPM within the range of 5 to 15 RPM based on the power delivered to the electrical load.</p>
<p>There are 16 buckets, each with a capacity of 48 liters. I’ll assum that the buckets will fill to a level of 95% of the bucket volumn. However, Kris stated in his video, that he though the bucket capacity was more like 50 liters because of the side wall of the wheel frame. In all the water wheels that I have observed on various YouTube videos, the buckets don’t fill to 100%. I’ll assume that the buckets are being filled to 95% of capacity.</p>
<!--
#| echo: false
#number_of_buckets = 16/(1*ureg.circle)
#wheel_width = 0.8*ureg.meter
#bucket_volume = 48*ureg.liter
#water_wheel_diameter = 2.1*ureg.meter
#bucket_capacity_utilization = 0.95

#print('number_of_buckets: {:f}'.format(number_of_buckets))
#print('wheel_width: {:f}'.format(wheel_width))
#print('bucket_volume: {:f}'.format(bucket_volume))
#print('water_wheel_diameter: {:f}'.format(water_wheel_diameter))
#print('bucket_capacity_utilization: {:f}'.format(bucket_capacity_utilization))
-->
<section id="water-carring-capacity-vs-rpm" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="water-carring-capacity-vs-rpm"><span class="header-section-number">4.6.1</span> Water carring capacity vs rpm</h3>
<p>For a give rpm and fill level, the water wheel can move a fixed amount of water. The water carring capacity is calculated by taking the rotation frequency times the number if buckets times the bucket capacity utilization. The Python pint library keeps track of the units. The number of buckets has the dimention of 16 per circle, so the product of the terms has dimentions that can be converted to liters per second.</p>
<p>The water wheel carring capacity at various flow rates is plotted below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I’m not sugesting that the water wheel can actually carry the volumn of water at RPM’s above 12 or so. The efficient filling of buckets probably requires that the tangential velocity of the water wheel approximately matches the water velocity at the flume exit.</p>
</div>
</div>
<div id="cell-fig-rpm2lps" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    (water_wheel_rotation_frequency<span class="op">*</span>sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket utilization'</span>]).to(<span class="st">'liter/sec'</span>).magnitude, <span class="st">'-'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># hightlight the operating band, 8 to 14 RPM</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">6</span>, <span class="dv">12</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.xlim((<span class="dv">4</span>,<span class="dv">15</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylim((40,200))</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'water carring capacity, l/s'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wheel RPM'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'water carring capacity, buckets are </span><span class="sc">{:.0f}% f</span><span class="st">ull'</span>.<span class="bu">format</span>(sys_param[<span class="st">'bucket utilization'</span>]<span class="op">*</span><span class="dv">100</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rpm2lps" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rpm2lps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-rpm2lps-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rpm2lps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: water carring capacity vs water wheel RPM
</figcaption>
</figure>
</div>
</div>
</div>
<!--

The wheel carring capacity versus wheel RPM is tabulated below. 


table_header = ['wheel rpm', 'water carring capacity, lps']
table_row = []

for i in water_wheel_rotation_frequency:
    table_row.append([i.to('rpm').magnitude,(i*sys_param['number of buckets']*sys_param['bucket volume']*sys_param['bucket utilization']).to('liter/sec').magnitude])

Markdown(tabulate(table_row, headers=table_header,colalign = ('left','left'),tablefmt="simple",floatfmt=('.0f',',.1f')))

::: {#cell-47 .cell execution_count=13}

::: {.cell-output .cell-output-stdout}
```
wheel rpm    water carring capacity, lps
-----------  -----------------------------
5            60.8
6            73.0
7            85.1
8            97.3
9            109.4
10           121.6
11           133.8
12           145.9
13           158.1
14           170.2
15           182.4
16           194.6
17           206.7
18           218.9
19           231.0
20           243.2
```
:::
:::


-->
<p>At 10 RPM, the wheel can move at most 121 lps. At higher flow rates, the excess water will overflow the buckets and not contribute any additional weight to the bucket and consequently torque to the wheel. I did notice that the water velocity in the flume was too high and buckets were not filling efficiently except at very low flow rates.</p>
</section>
</section>
<section id="power-equilibrium" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="power-equilibrium"><span class="header-section-number">4.7</span> Power equilibrium</h2>
<p>The calculations that follow will estimate the equilibrium point between the power produced by the water wheel and the power consumed by the electrical load. The assumption is that the buckets are being filled efficiently. However, we know that if the water velocity is too high the buckets will not fully fill since a lot of the water will splash out of the buckets. The water velocity entering the buckets needs to be about the same as the tangential wheel velocity.</p>
<section id="water-wheel-torque-vs-rpm" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="water-wheel-torque-vs-rpm"><span class="header-section-number">4.7.1</span> Water wheel torque vs rpm</h3>
<p>The force that turns the wheel is provided by gravity and the mass of the water. Only about half of the buchets on one side of the wheel are filled with water and the weight imbalance causes the wheel to turn under the force of gravity. The turning force us called <a href="https://en.wikipedia.org/wiki/Torque">torque</a> and is a measure of the force that produces a rotation. To calculate the torque, we use the horizontal distance of each bucket with water from the axis of the wheel multiplied by the force of gravity acting on the mass of the water. The units of torque are <a href="https://en.wikipedia.org/wiki/Newton_(unit)">Newton</a> meters.</p>
<p>The moment arm for each bucket on one side of the wheel is calculated by taking the sin of angle for each buckets position and mutiplying by the radius of the wheel. We want to do a series of calculations for a set of flow rates and water wheel rotational speeds. Each bucket can only carry 47 liters, so if the flow rate is too high for the rotational speed, the butckets will over flow and only the weight of the actual water in the bucket is counted.</p>
<p>The calculations below assume that the water is filling the buckets in an efficicent manner and the momentum of the water is not included in the torque calculatons. If the water did have a lot of momentum, it would splash out of the buckets rather than filling them, which is what we see in the videos.</p>
<div id="cell-fig-rpm2torque" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the horizontal distance for each bucket on one side</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi,<span class="bu">int</span>(sys_param[<span class="st">'number of buckets'</span>].magnitude<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>moment_arm <span class="op">=</span> (sys_param[<span class="st">'wheel diameter'</span>]<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>np.sin(x)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># do the calculations from 5 to 20 rpm using 100 points</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>water_wheel_rotation_frequency <span class="op">=</span> (np.linspace(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">100</span>))<span class="op">*</span>ureg.rpm</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Q)):  <span class="co"># use the same flow rate range from above</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    water_wheel_shaft_torque <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.kilogram<span class="op">*</span>ureg.g0<span class="op">*</span>ureg.meter <span class="co"># creat an empty array with the proper units attached</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(water_wheel_rotation_frequency)):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># given the rotational rate, how much water can be moved, if the buckets were full?</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        water_transport_rate <span class="op">=</span> (sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j]).to(<span class="st">'liter/sec'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        bucket_utilization <span class="op">=</span> Q[i]<span class="op">/</span>water_transport_rate <span class="co"># estimate of how full the buckets are</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># limit transport rate to flow rate</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> bucket_utilization <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            bucket_utilization <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            water_transport_rate <span class="op">=</span> Q[i]</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        weight_of_water_per_bucket <span class="op">=</span> (rho<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>])<span class="op">*</span>bucket_utilization</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        torque_per_bucket <span class="op">=</span> (weight_of_water_per_bucket<span class="op">*</span>ureg.g0<span class="op">*</span>moment_arm).to_base_units()</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        water_wheel_shaft_torque[j] <span class="op">=</span> torque_per_bucket.<span class="bu">sum</span>()    </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    plt.plot(water_wheel_rotation_frequency.magnitude,water_wheel_shaft_torque.to(<span class="st">'N m'</span>).magnitude,<span class="st">'-'</span>,label<span class="op">=</span><span class="st">'{:.1f~P}'</span>.<span class="bu">format</span>(Q[i]))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># hightlight the operating band, 8 to 14 RPM</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">6</span>, <span class="dv">12</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'water wheel shaft torque, N m'</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wheel rpm'</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Water wheel shaft torque vs RPM at various flow rates'</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rpm2torque" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rpm2torque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-rpm2torque-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rpm2torque-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Water wheel shaft torque vs RPM at various flow rates
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot above shows the water wheel shaft torque over a range of wheel RPM and flow rates. At the lowest flow rate plotted, 40 lps, the buckets do not completely fill at any of the wheel RPMs plotted. The 60 lps torque curve decreases with increasing RPM because at higher rotational speeds, there is less water in each bucket, which contributes less force to the moment arm. At the next flow rate plotted, 80 lps, you can see that at a wheel RPM of just under 6, the buckets are completely full and the torque is constant at about 2164 Nm. At the highest flow rate plotted, 180 lps, if the wheel is spinning faster than 14 RPM, the buckets are only partially filled with water and the torque decreases with wheel RPM. This analysis assumes that the buckets can efficiently fill with water over the range of rotational speeds; but above 12 RPM this is doubtful since there will likely be a mismatch between the water velocity in the flume and the tangential velocity of the wheel.</p>
</section>
<section id="water-wheel-shaft-power-vs-rpm" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="water-wheel-shaft-power-vs-rpm"><span class="header-section-number">4.7.2</span> Water wheel shaft power vs rpm</h3>
<p>Having calculated the water wheel shaft torque over a range of wheel RPMs and flow rates, we can use the same method to calculate the water wheel shaft power, which is the product of torque, rotational speed and water wheel efficiency.</p>
<div id="cell-fig-rpm2pwr" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Q)):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    water_wheel_shaft_torque <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.kilogram<span class="op">*</span>ureg.g0<span class="op">*</span>ureg.meter</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(water_wheel_rotation_frequency)):</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        water_transport_rate <span class="op">=</span> (sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j]).to(<span class="st">'liter/sec'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        bucket_utilization <span class="op">=</span> Q[i]<span class="op">/</span>water_transport_rate</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># limit transport rate to flow rate</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> bucket_utilization <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            bucket_utilization <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            water_transport_rate <span class="op">=</span> Q[i]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        weight_of_water_per_bucket <span class="op">=</span> (rho<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>])<span class="op">*</span>bucket_utilization</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        torque_per_bucket <span class="op">=</span> (weight_of_water_per_bucket<span class="op">*</span>ureg.g0<span class="op">*</span>moment_arm).to_base_units()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        water_wheel_shaft_torque[j] <span class="op">=</span> torque_per_bucket.<span class="bu">sum</span>()    </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    plt.plot(water_wheel_rotation_frequency.magnitude,(water_wheel_shaft_torque<span class="op">*</span>water_wheel_rotation_frequency<span class="op">*</span>eta_waterwheel).to(<span class="st">'watts'</span>).magnitude,<span class="st">'-'</span>,label<span class="op">=</span><span class="st">'{:.1f~P}'</span>.<span class="bu">format</span>(Q[i]))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># hightlight the operating band, 8 to 14 RPM</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">6</span>, <span class="dv">12</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'water wheel shaft power, Watts'</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wheel rpm'</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Water wheel shaft power vs RPM at various flow rates'</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-rpm2pwr" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rpm2pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-rpm2pwr-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rpm2pwr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Water wheel shaft power vs RPM at various flow rates
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot above shows that the water wheel shaft power is constant for a flow rate of 60 lps. A faster spinning wheel will have less torque since the buckets are less full and less weight in the buckets produces less torque, but since power is the product of torque and rotational speed, the result is constant over the range of RPMs. At the highest flow rate of 180 lps, the shaft power increases with wheel RPM since up to about 14 RPM where the buckets are completely full.</p>
<p>The shape of the power curve versus wheel RPM indicates that a Maximum Power Point Tracking (MPPT) algorithm will hunt for a peak in the curve, probably by letting the RPM increase, where at some point the buckets will not fill efficiently and there will be a decrease in torque. This would suggest that MPPT is not ideal.</p>
<p><strong>Power equilibrium at 100 lps</strong><br>
The calculations below, tabulate the water wheel shaft torque and water wheel shaft power at a flow rate of 100 lps over a range of RPMs. The water wheel shaft power is labeled here as available power. Available power is the power the water wheel could deliver if it was allowed to rotate at the particular RPM indicated in each row of the table. For each water wheel RPM, the generator line to line voltage is calculated using a straight line approximation based on the ratio of 220 volts to 500 RPM and the DC voltage, current and electrical power on the load is calculated.</p>
<div class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>water_wheel_rotation_frequency <span class="op">=</span> (np.arange(<span class="dv">5</span>,<span class="dv">21</span>))<span class="op">*</span>ureg.rpm</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">3</span> <span class="co"># index of 3 is 120 lps</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'flow'</span>,<span class="st">'rpm'</span>,<span class="st">'torque'</span>,<span class="st">'avaliable pwr'</span>,<span class="st">'load volts'</span>,<span class="st">'load amps'</span>,<span class="st">'load pwr'</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>water_wheel_shaft_torque <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.kilogram<span class="op">*</span>ureg.g0<span class="op">*</span>ureg.meter</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(water_wheel_rotation_frequency)):</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    water_transport_rate <span class="op">=</span> (sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j]).to(<span class="st">'liter/sec'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    bucket_utilization <span class="op">=</span> Q[i]<span class="op">/</span>water_transport_rate</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># limit transport rate to flow rate</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bucket_utilization <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        bucket_utilization <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        water_transport_rate <span class="op">=</span> Q[i]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    weight_of_water_per_bucket <span class="op">=</span> (rho<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>])<span class="op">*</span>bucket_utilization</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    torque_per_bucket <span class="op">=</span> (weight_of_water_per_bucket<span class="op">*</span>ureg.g0<span class="op">*</span>moment_arm).to_base_units()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    water_wheel_shaft_torque[j] <span class="op">=</span> torque_per_bucket.<span class="bu">sum</span>()    </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the avaliable power produced by the water wheel</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    available_pwr <span class="op">=</span> (water_wheel_shaft_torque[j]<span class="op">*</span>water_wheel_rotation_frequency[j]<span class="op">*</span>eta_waterwheel)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the generator output voltage at each rotational speed</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    V_line_line_rms <span class="op">=</span> sys_param[<span class="st">'volts to RPM'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j].magnitude<span class="op">*</span>sys_param[<span class="st">'gear ratio'</span>]<span class="op">*</span>ureg.volt</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Vp_rms = V_line_line_rms/np.sqrt(3)</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Vp_peak = Vp_rms*np.sqrt(2)</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">#V_load = (3*np.sqrt(6)/np.pi)*Vp_rms</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    V_load <span class="op">=</span> V_line_line_rms<span class="op">*</span><span class="dv">3</span><span class="op">*</span>np.sqrt(<span class="dv">2</span>)<span class="op">/</span>np.pi</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    load_current <span class="op">=</span> V_load<span class="op">/</span>R_load</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    load_pwr <span class="op">=</span> (R_load<span class="op">*</span>load_current<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>eta_gear_box<span class="op">*</span>eta_generator    </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#load_volts = (220/500)*water_wheel_rotation_frequency[j].magnitude*gear_box*ureg.volt</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#load_current = load_volts/R_load</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">#load_pwr = R_load*load_current**2</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    table_row.append(</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>            [Q[i].magnitude,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>            water_wheel_rotation_frequency[j].magnitude,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>            water_wheel_shaft_torque[j].to(<span class="st">'N m'</span>).magnitude,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>            available_pwr.to(<span class="st">'watts'</span>).magnitude,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>            V_load.magnitude,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>            load_current.magnitude,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            load_pwr.magnitude])                                                                   </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'decimal'</span>,<span class="st">'decimal'</span>,<span class="st">'decimal'</span>,<span class="st">'decimal'</span>,<span class="st">'decimal'</span>,<span class="st">'decimal'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>,floatfmt<span class="op">=</span>(<span class="st">'.0f'</span>,<span class="st">'.0f'</span>,<span class="st">',.1f'</span>,<span class="st">',.1f'</span>,<span class="st">'.1f'</span>,<span class="st">'.1f'</span>,<span class="st">',.1f'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-pwr-equil" class="cell quarto-float anchored" data-execution_count="16">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pwr-equil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Power equilibrium
</figcaption>
<div aria-describedby="tbl-pwr-equil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="16">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">flow</th>
<th style="text-align: right;">rpm</th>
<th style="text-align: right;">torque</th>
<th style="text-align: right;">avaliable pwr</th>
<th style="text-align: right;">load volts</th>
<th style="text-align: right;">load amps</th>
<th style="text-align: right;">load pwr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2,164.9</td>
<td style="text-align: right;">1,020.2</td>
<td style="text-align: right;">118.8</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">205.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2,164.9</td>
<td style="text-align: right;">1,224.2</td>
<td style="text-align: right;">142.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">295.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2,164.9</td>
<td style="text-align: right;">1,428.3</td>
<td style="text-align: right;">166.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">402.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2,114.2</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">190.1</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">525.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1,879.3</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">213.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">664.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1,691.4</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">237.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">820.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1,537.6</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">261.5</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">993.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1,409.5</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">285.2</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1,182.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1,301.0</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">309.0</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">1,387.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1,208.1</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">332.8</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">1,608.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">1,127.6</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">356.5</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">1,846.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1,057.1</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">380.3</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">2,101.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">994.9</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">404.1</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">2,372.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">939.6</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">427.8</td>
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">2,659.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">890.2</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">451.6</td>
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2,963.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">845.7</td>
<td style="text-align: right;">1,594.1</td>
<td style="text-align: right;">475.4</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">3,283.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--

::: {#cell-57 .cell execution_count=17}
``` {.python .cell-code}
print(tabulate(table_row, headers=table_header,colalign = ('left','decimal','decimal','decimal','decimal','decimal','decimal'),tablefmt="simple",floatfmt=('.0f','.0f',',.1f',',.1f','.1f','.1f',',.1f')))
```

::: {.cell-output .cell-output-stdout}
```
flow      rpm    torque    avaliable pwr    load volts    load amps    load pwr
------  -----  --------  ---------------  ------------  -----------  ----------
100         5   2,164.9          1,020.2         118.8          2.0       205.2
100         6   2,164.9          1,224.2         142.6          2.4       295.5
100         7   2,164.9          1,428.3         166.4          2.8       402.2
100         8   2,114.2          1,594.1         190.1          3.2       525.3
100         9   1,879.3          1,594.1         213.9          3.6       664.8
100        10   1,691.4          1,594.1         237.7          4.0       820.8
100        11   1,537.6          1,594.1         261.5          4.4       993.2
100        12   1,409.5          1,594.1         285.2          4.8     1,182.0
100        13   1,301.0          1,594.1         309.0          5.3     1,387.2
100        14   1,208.1          1,594.1         332.8          5.7     1,608.8
100        15   1,127.6          1,594.1         356.5          6.1     1,846.8
100        16   1,057.1          1,594.1         380.3          6.5     2,101.2
100        17     994.9          1,594.1         404.1          6.9     2,372.1
100        18     939.6          1,594.1         427.8          7.3     2,659.4
100        19     890.2          1,594.1         451.6          7.7     2,963.1
100        20     845.7          1,594.1         475.4          8.1     3,283.2
```
:::
:::


-->
<p>The available power and the load power will reach equilibrium at around 14 RPM. The point of intercestion is plotted below.</p>
<div id="cell-fig-pwr-equil" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>water_wheel_rotation_frequency <span class="op">=</span> (np.linspace(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">100</span>))<span class="op">*</span>ureg.rpm</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize some empty arrays</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>water_wheel_shaft_torque <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.kilogram<span class="op">*</span>ureg.g0<span class="op">*</span>ureg.meter</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>available_pwr <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.watt</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>load_pwr <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.watt</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(water_wheel_rotation_frequency)):</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    water_transport_rate <span class="op">=</span> (sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j]).to(<span class="st">'liter/sec'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    bucket_utilization <span class="op">=</span> Q[i]<span class="op">/</span>water_transport_rate</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># limit transport rate to flow rate</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bucket_utilization <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        bucket_capacity_utilization <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        water_transport_rate <span class="op">=</span> Q[i]</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    weight_of_water_per_bucket <span class="op">=</span> (rho<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>])<span class="op">*</span>bucket_utilization</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    torque_per_bucket <span class="op">=</span> (weight_of_water_per_bucket<span class="op">*</span>ureg.g0<span class="op">*</span>moment_arm).to_base_units()</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    water_wheel_shaft_torque[j] <span class="op">=</span> torque_per_bucket.<span class="bu">sum</span>()    </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the generator out put voltage at each rotational speed</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    available_pwr[j] <span class="op">=</span> (water_wheel_shaft_torque[j]<span class="op">*</span>water_wheel_rotation_frequency[j]<span class="op">*</span>eta_waterwheel)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    V_line_line_rms <span class="op">=</span> sys_param[<span class="st">'volts to RPM'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j].magnitude<span class="op">*</span>sys_param[<span class="st">'gear ratio'</span>]<span class="op">*</span>ureg.volt</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Vp_rms = V_line_line_rms/np.sqrt(3)</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Vp_peak = Vp_rms*np.sqrt(2)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#V_load = (3*np.sqrt(6)/np.pi)*Vp_rms</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    V_load <span class="op">=</span> V_line_line_rms<span class="op">*</span><span class="dv">3</span><span class="op">*</span>np.sqrt(<span class="dv">2</span>)<span class="op">/</span>np.pi</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    load_current <span class="op">=</span> V_load<span class="op">/</span>R_load</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    load_pwr[j] <span class="op">=</span> (R_load<span class="op">*</span>load_current<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>eta_gear_box<span class="op">*</span>eta_generator  </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude, available_pwr.to(<span class="st">'watts'</span>).magnitude,<span class="st">'-'</span>,label<span class="op">=</span><span class="st">'available pwr'</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude, load_pwr.to(<span class="st">'watts'</span>).magnitude,<span class="st">'-'</span>,label<span class="op">=</span><span class="st">'load pwr'</span>)  </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> np.argwhere(np.diff(np.sign(load_pwr.to(<span class="st">'watts'</span>).magnitude <span class="op">-</span> available_pwr.to(<span class="st">'watts'</span>).magnitude))).flatten()</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude[idx], load_pwr.to(<span class="st">'watts'</span>).magnitude[idx], <span class="st">'ro'</span>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude[idx], available_pwr.to(<span class="st">'watts'</span>).magnitude[idx], <span class="st">'kx'</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co"># hightlight the operating band, 6 to 12 RPM</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">6</span>, <span class="dv">12</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'power, Watts'</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wheel rpm'</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'available power from water wheel, power to R_load = {:.1f~P} @ flow = {:.1f~P}'</span>.<span class="bu">format</span>(R_load,Q[i]))</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-pwr-equil" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pwr-equil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-pwr-equil-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pwr-equil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Power equilibrium
</figcaption>
</figure>
</div>
</div>
</div>
<!--

::: {#cell-62 .cell execution_count=19}
``` {.python .cell-code}
water_wheel_rotation_frequency
```

::: {.cell-output .cell-output-display execution_count=19}

```{=html}

<table data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td style="text-align: left;"><pre><code>[5.0 5.151515151515151 5.303030303030303 5.454545454545455
 5.606060606060606 5.757575757575758 5.909090909090909 6.0606060606060606
 6.212121212121212 6.363636363636363 6.515151515151516 6.666666666666667
 6.818181818181818 6.96969696969697 7.121212121212121 7.272727272727273
 7.424242424242424 7.575757575757576 7.7272727272727275 7.878787878787879
 8.030303030303031 8.181818181818182 8.333333333333334 8.484848484848484
 8.636363636363637 8.787878787878789 8.93939393939394 9.09090909090909
 9.242424242424242 9.393939393939394 9.545454545454547 9.696969696969697
 9.848484848484848 10.0 10.151515151515152 10.303030303030303
 10.454545454545455 10.606060606060606 10.757575757575758
 10.90909090909091 11.06060606060606 11.212121212121211 11.363636363636363
 11.515151515151516 11.666666666666668 11.818181818181818
 11.969696969696969 12.121212121212121 12.272727272727273
 12.424242424242426 12.575757575757576 12.727272727272727
 12.878787878787879 13.030303030303031 13.181818181818182
 13.333333333333334 13.484848484848484 13.636363636363637
 13.787878787878789 13.93939393939394 14.090909090909092
 14.242424242424242 14.393939393939394 14.545454545454545
 14.696969696969697 14.84848484848485 15.0 15.151515151515152
 15.303030303030303 15.454545454545455 15.606060606060606
 15.757575757575758 15.90909090909091 16.060606060606062 16.21212121212121
 16.363636363636363 16.515151515151516 16.666666666666668
 16.81818181818182 16.96969696969697 17.12121212121212 17.272727272727273
 17.424242424242422 17.575757575757578 17.727272727272727
 17.87878787878788 18.03030303030303 18.18181818181818 18.333333333333336
 18.484848484848484 18.636363636363637 18.78787878787879
 18.939393939393938 19.090909090909093 19.242424242424242
 19.393939393939394 19.545454545454547 19.696969696969695
 19.84848484848485 20.0]</code></pre></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Units</td>
<td style="text-align: left;">revolutions_per_minute</td>
</tr>
</tbody>
</table>
``` ::: ::: ::: {#cell-63 .cell execution_count=20} ``` {.python .cell-code} water_wheel_shaft_torque ``` ::: {.cell-output .cell-output-display execution_count=20} ```{=html}
<table data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td style="text-align: left;"><pre><code>[344.9400369949754 334.7947417892408 325.22917773811963 316.19503391206075
 307.64922218470775 299.5531900219523 291.8723389957484 284.5755305208547
 277.634663922785 271.02431478176635 264.7214237403299 258.7050277462315
 252.95602712964865 247.45698306161276 242.1919408688125
 237.14627543404558 232.3065555272283 227.66042441668372
 223.19649452616054 218.90425424681132 214.77398529875825
 210.79668927470718 206.96402219698524 203.2682360863248
 199.70212668130154 196.25898656610664 192.9325630649862
 189.71702034723648 186.60690525957688 183.59711646506747
 180.68287652117755 177.85970657553418 175.12340339744907
 172.4700184974877 169.89583911692816 167.3973708946204 164.97132204107513
 162.61458886905982 160.3242425469604 158.09751695603038 155.9317975456738
 153.8246110923539 151.77361627778913 149.77659501097614 147.831444426418
 145.9361694978742 144.08887621309103 142.28776526042736
 140.53112618313813 138.8173319613925 137.14483398595405
 135.51215739088317 133.91789671569632 132.36071187016495
 130.83932437740444 129.35251387311575 127.89911484083358
 126.47801356482432 125.08814528389216 123.72849153080638
 122.39807764337837 121.09597043440625 119.82127600878088
 118.57313771702282 117.350734235404 116.15327776361416 114.98001233165844
 113.83021220834186 112.7031804042989 111.59824726308027
 110.51476913431252 109.45212712340566 108.40972591270653
 107.38699264937912 106.3833758956466 105.39834463735359
 104.43138734710264 103.48201109849262 102.54974072823593
 101.6341180431624 100.73470106932909 99.85106334065077 98.98279322464512
 98.12949328305332 97.29077966524946 96.4662815324931 95.65564051121166
 94.85851017361824 94.07455554408418 93.30345262978844 92.5448879742617
 91.79855823253374 91.0641697666735 90.34143826058877 89.6300883530251
 88.92985328776709 88.24047458010996 87.56170169872453 86.89329176209301
 86.23500924874385]</code></pre></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Units</td>
<td style="text-align: left;">kilogram meter standard_gravity</td>
</tr>
</tbody>
</table>
``` ::: ::: ::: {#cell-64 .cell execution_count=21} ``` {.python .cell-code} water_wheel_shaft_torque*water_wheel_rotation_frequency ``` ::: {.cell-output .cell-output-display execution_count=21} ```{=html}
<table data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td style="text-align: left;"><pre><code>[1724.700184974877 1724.7001849748767 1724.7001849748767 1724.700184974877
 1724.700184974877 1724.7001849748767 1724.700184974877 1724.7001849748772
 1724.7001849748767 1724.7001849748767 1724.7001849748767
 1724.7001849748767 1724.7001849748772 1724.7001849748767
 1724.700184974877 1724.7001849748772 1724.7001849748767
 1724.7001849748767 1724.700184974877 1724.7001849748772 1724.700184974877
 1724.700184974877 1724.7001849748772 1724.700184974877 1724.700184974877
 1724.7001849748767 1724.7001849748767 1724.700184974877
 1724.7001849748772 1724.7001849748763 1724.7001849748767
 1724.700184974877 1724.700184974877 1724.700184974877 1724.700184974877
 1724.7001849748767 1724.7001849748765 1724.7001849748767
 1724.700184974877 1724.700184974877 1724.7001849748767 1724.700184974877
 1724.7001849748765 1724.7001849748767 1724.7001849748767
 1724.700184974877 1724.7001849748774 1724.7001849748772
 1724.7001849748772 1724.700184974877 1724.7001849748767
 1724.7001849748767 1724.7001849748767 1724.7001849748767
 1724.7001849748767 1724.7001849748767 1724.700184974877
 1724.7001849748772 1724.700184974877 1724.7001849748767
 1724.7001849748772 1724.700184974877 1724.7001849748765
 1724.7001849748772 1724.7001849748772 1724.700184974877
 1724.7001849748767 1724.7001849748767 1724.7001849748772
 1724.700184974877 1724.7001849748772 1724.7001849748772
 1724.7001849748767 1724.700184974877 1724.7001849748765 1724.700184974877
 1724.700184974877 1724.7001849748772 1724.7001849748772 1724.700184974877
 1724.700184974877 1724.700184974877 1724.700184974877 1724.7001849748767
 1724.7001849748767 1724.7001849748767 1724.700184974877 1724.700184974877
 1724.7001849748767 1724.7001849748772 1724.7001849748772
 1724.7001849748763 1724.7001849748767 1724.7001849748767
 1724.700184974877 1724.700184974877 1724.7001849748767 1724.700184974877
 1724.7001849748767 1724.700184974877]</code></pre></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Units</td>
<td style="text-align: left;">kilogram meter revolutions_per_minute standard_gravity</td>
</tr>
</tbody>
</table>
``` ::: ::: ::: {#cell-65 .cell execution_count=22} ``` {.python .cell-code} available_pwr ``` ::: {.cell-output .cell-output-display execution_count=22} ```{=html}
<table data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Magnitude</td>
<td style="text-align: left;"><pre><code>[1594.0627485774742 1594.062748577474 1594.062748577474 1594.0627485774742
 1594.0627485774742 1594.062748577474 1594.0627485774742
 1594.0627485774744 1594.062748577474 1594.062748577474 1594.062748577474
 1594.062748577474 1594.0627485774744 1594.062748577474 1594.0627485774742
 1594.0627485774744 1594.062748577474 1594.062748577474 1594.0627485774742
 1594.0627485774744 1594.0627485774742 1594.0627485774742
 1594.0627485774744 1594.0627485774742 1594.0627485774742
 1594.062748577474 1594.062748577474 1594.0627485774742 1594.0627485774744
 1594.0627485774735 1594.062748577474 1594.0627485774742
 1594.0627485774742 1594.0627485774742 1594.0627485774742
 1594.062748577474 1594.0627485774737 1594.062748577474 1594.0627485774742
 1594.0627485774742 1594.062748577474 1594.0627485774742
 1594.0627485774737 1594.062748577474 1594.062748577474 1594.0627485774742
 1594.0627485774746 1594.0627485774744 1594.0627485774744
 1594.0627485774742 1594.062748577474 1594.062748577474 1594.062748577474
 1594.062748577474 1594.062748577474 1594.062748577474 1594.0627485774742
 1594.0627485774744 1594.0627485774742 1594.062748577474
 1594.0627485774744 1594.0627485774742 1594.0627485774737
 1594.0627485774744 1594.0627485774744 1594.0627485774742
 1594.062748577474 1594.062748577474 1594.0627485774744 1594.0627485774742
 1594.0627485774744 1594.0627485774744 1594.062748577474
 1594.0627485774742 1594.0627485774737 1594.0627485774742
 1594.0627485774742 1594.0627485774744 1594.0627485774744
 1594.0627485774742 1594.0627485774742 1594.0627485774742
 1594.0627485774742 1594.062748577474 1594.062748577474 1594.062748577474
 1594.0627485774742 1594.0627485774742 1594.062748577474
 1594.0627485774744 1594.0627485774744 1594.0627485774735
 1594.062748577474 1594.062748577474 1594.0627485774742 1594.0627485774742
 1594.062748577474 1594.0627485774742 1594.062748577474 1594.0627485774742]</code></pre></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Units</td>
<td style="text-align: left;">watt</td>
</tr>
</tbody>
</table>

```

:::
:::


-->
<div id="cell-67" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print('the curves intersect at {:.1f} rpm and {:.1f} W'.format(float(water_wheel_rotation_frequency.magnitude[idx]),float(load_pwr.to('watts').magnitude[idx])))</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The plot above shows that equilibrium will be reached when the available power from the water wheel matches the electrical </span><span class="ch">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">power delivered to the load resistor at </span><span class="sc">{:.1f}</span><span class="st"> RPM and </span><span class="sc">{:.1f}</span><span class="st"> Watts.'</span>.<span class="bu">format</span>(<span class="bu">float</span>(water_wheel_rotation_frequency.magnitude[idx]), <span class="bu">float</span>(load_pwr.to(<span class="st">'watts'</span>).magnitude[idx])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="23">
<p>The plot above shows that equilibrium will be reached when the available power from the water wheel matches the electrical power delivered to the load resistor at 13.8 RPM and 1560.4 Watts.</p>
</div>
</div>
<p>By calculating the equilibrium point, we can estimate the rotational speed of the water wheel under load. As discussed below, 15 RPM is too fast for the efficient filling of the buckets. This indicates that the gearbox ratio need to be higher. By adjusting the gearbox ratio and re-running the calculations above, a gearbox ratio of 50 will produce equilibrium at about 10 RPM.</p>
<p><strong>Power equilibrium vs flow rate</strong><br>
<span class="math inline">\(\large{\color {red} {\text{why is the blue line flat? should it not ahve a knee below 8 RPM?}}}\)</span></p>
<div id="cell-69" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The power equilibrium points for a gear ratio of 1:</span><span class="sc">{:d}</span><span class="st"> are tabulated below.'</span>.<span class="bu">format</span>(sys_param[<span class="st">'gear ratio'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="24">
<p>The power equilibrium points for a gear ratio of 1:40 are tabulated below.</p>
</div>
</div>
<div class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>water_wheel_rotation_frequency <span class="op">=</span> (np.linspace(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">100</span>))<span class="op">*</span>ureg.rpm</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'flow, lps'</span>,<span class="st">'wheel rotation, RPM'</span>,<span class="st">'load pwr, W'</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Q)):</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    water_wheel_shaft_torque <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.kilogram<span class="op">*</span>ureg.g0<span class="op">*</span>ureg.meter</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    available_pwr <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.watt</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    load_pwr <span class="op">=</span> np.zeros(<span class="bu">len</span>(water_wheel_rotation_frequency))<span class="op">*</span>ureg.watt</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(water_wheel_rotation_frequency)):</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        water_transport_rate <span class="op">=</span> (sys_param[<span class="st">'number of buckets'</span>]<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j]).to(<span class="st">'liter/sec'</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        bucket_utilization <span class="op">=</span> Q[i]<span class="op">/</span>water_transport_rate</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># limit transport rate to flow rate</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> bucket_utilization <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            bucket_utilization <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            water_transport_rate <span class="op">=</span> Q[i]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        weight_of_water_per_bucket <span class="op">=</span> (rho<span class="op">*</span>sys_param[<span class="st">'bucket volume'</span>])<span class="op">*</span>bucket_utilization</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        torque_per_bucket <span class="op">=</span> (weight_of_water_per_bucket<span class="op">*</span>ureg.g0<span class="op">*</span>moment_arm).to_base_units()</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        water_wheel_shaft_torque[j] <span class="op">=</span> torque_per_bucket.<span class="bu">sum</span>()    </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate the generator out put voltage at each rotational speed</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        available_pwr[j] <span class="op">=</span> (water_wheel_shaft_torque[j]<span class="op">*</span>water_wheel_rotation_frequency[j]<span class="op">*</span>eta_waterwheel)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        V_line_line_rms <span class="op">=</span> sys_param[<span class="st">'volts to RPM'</span>]<span class="op">*</span>water_wheel_rotation_frequency[j].magnitude<span class="op">*</span>sys_param[<span class="st">'gear ratio'</span>]<span class="op">*</span>ureg.volt</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Vp_rms = V_line_line_rms/np.sqrt(3)</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Vp_peak = Vp_rms*np.sqrt(2)</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">#V_load = (3*np.sqrt(6)/np.pi)*Vp_rms</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        V_load <span class="op">=</span> V_line_line_rms<span class="op">*</span><span class="dv">3</span><span class="op">*</span>np.sqrt(<span class="dv">2</span>)<span class="op">/</span>np.pi</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        load_current <span class="op">=</span> V_load<span class="op">/</span>R_load</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        load_pwr[j] <span class="op">=</span> (R_load<span class="op">*</span>load_current<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>eta_gear_box<span class="op">*</span>eta_generator</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.argwhere(np.diff(np.sign(load_pwr.to(<span class="st">'watts'</span>).magnitude <span class="op">-</span> available_pwr.to(<span class="st">'watts'</span>).magnitude))).flatten()</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    table_row.append([Q[i].magnitude,water_wheel_rotation_frequency.magnitude[idx],load_pwr.to(<span class="st">'watts'</span>).magnitude[idx]])</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>                                                                       </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>,floatfmt<span class="op">=</span>(<span class="st">'.0f'</span>,<span class="st">',.2f'</span>,<span class="st">'.1f'</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-pwr-equil-intersection" class="cell quarto-float anchored" data-execution_count="25">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pwr-equil-intersection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Power equilibrium intersection points at various flow rates
</figcaption>
<div aria-describedby="tbl-pwr-equil-intersection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="25">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">flow, lps</th>
<th style="text-align: left;">wheel rotation, RPM</th>
<th style="text-align: left;">load pwr, W</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">40</td>
<td style="text-align: left;">8.79</td>
<td style="text-align: left;">633.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">60</td>
<td style="text-align: left;">10.76</td>
<td style="text-align: left;">949.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80</td>
<td style="text-align: left;">12.42</td>
<td style="text-align: left;">1267.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">100</td>
<td style="text-align: left;">13.79</td>
<td style="text-align: left;">1560.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">120</td>
<td style="text-align: left;">15.15</td>
<td style="text-align: left;">1884.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">140</td>
<td style="text-align: left;">16.36</td>
<td style="text-align: left;">2197.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">160</td>
<td style="text-align: left;">17.58</td>
<td style="text-align: left;">2535.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">180</td>
<td style="text-align: left;">18.64</td>
<td style="text-align: left;">2850.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--

::: {#cell-72 .cell execution_count=26}
``` {.python .cell-code}
print(tabulate(table_row, headers=table_header,colalign = ('left','left','left'),tablefmt="simple",floatfmt=('.0f',',.2f','.1f'))) 
```

::: {.cell-output .cell-output-stdout}
```
flow, lps    wheel rotation, RPM    load pwr, W
-----------  ---------------------  -------------
40           8.79                   633.9
60           10.76                  949.9
80           12.42                  1267.0
100          13.79                  1560.4
120          15.15                  1884.3
140          16.36                  2197.8
160          17.58                  2535.5
180          18.64                  2850.8
```
:::
:::


-->
<p>With a gear ratio of 1:40, the hydro system will not make 1500 Watts at a reasonable water wheel RPM.</p>
</section>
<section id="wheel-tangential-velocity-vs-rpm" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="wheel-tangential-velocity-vs-rpm"><span class="header-section-number">4.7.3</span> Wheel tangential velocity vs RPM</h3>
<p>The water wheel tangential velocity versus RPM is plotted below. Water wheel rotational frequency, given the units of RPM, is being used to demote rotational speed or rotatinal rate. The units used in the calculations need to include the number <span class="math inline">\(2\pi\)</span> in the calculations because angular rate in radians is used in the calculations. Converting rtoatinal frequency to Hz takes care of the conversion.</p>
<div id="cell-fig-tangential-vel" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>water_wheel_rotation_frequency <span class="op">=</span> (np.arange(<span class="dv">5</span>,<span class="dv">16</span>))<span class="op">*</span>ureg.rpm</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.plot(water_wheel_rotation_frequency.magnitude,(sys_param[<span class="st">'wheel diameter'</span>]<span class="op">/</span><span class="dv">2</span><span class="op">*</span>water_wheel_rotation_frequency.to(<span class="st">'Hz'</span>)).to_base_units().magnitude,<span class="st">'-'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hightlight the operating band, 8 to 14 RPM</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">6</span>, <span class="dv">12</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Wheel tangential velocity, m/s'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wheel RPM'</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Wheel tangential velocity'</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-tangential-vel" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tangential-vel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Lake District Overshot Waterwheel Project_files/figure-html/fig-tangential-vel-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tangential-vel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Wheel tangential velocity
</figcaption>
</figure>
</div>
</div>
</div>
<!--
The tangental velocity is tabulated below:


table_header = ['wheel rpm', 'tangential velocity, m/s']
table_row = []

for i in water_wheel_rotation_frequency:
    table_row.append([i.to('rpm').magnitude,(sys_param['wheel diameter']/2*i.to('Hz')).to_base_units().magnitude])

Markdown(tabulate(table_row, headers=table_header,colalign = ('left','left'),tablefmt="simple",floatfmt=('.0f',',.2f')))

-->
<p>Flume water velocity should match the tangential velocity at the flow rate.</p>
</section>
</section>
<section id="generator" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="generator"><span class="header-section-number">4.8</span> Generator</h2>
<p>There were two types of generators used in the project. The initial type was a Perminate Magnet Generator (PMG). The second type was an induction generator. In part 1 of the video series, Kris indicated that PMG was a 2kW, 220 Volt generator. Later in part 2, the 220V PMG wass changed to a 96V PMG of the same type.</p>
<section id="kw-3-phase-pmg-220v96v-types" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="kw-3-phase-pmg-220v96v-types"><span class="header-section-number">4.8.1</span> 2kW 3 phase PMG, 220V/96V types</h3>
<p>First generator is a 2kW PM generator, exact specifications are not clear. Different voltages were used. Kris was unhappy about the perforance of the 1st generator.</p>
<p>The PMG is a Rewindagic generator obtained from from <a href="https://www.aliexpress.us/item/3256805810088713.html?spm=a2g0o.productlist.main.11.7c394d609UmWma&amp;algo_pvid=e88e2b0d-cefa-4d8f-87a4-75345f23b065&amp;algo_exp_id=e88e2b0d-cefa-4d8f-87a4-75345f23b065-5&amp;pdp_npi=4%40dis%21USD%211158.00%21555.84%21%21%211158.00%21%21%402101fb1a17010055921136573e7995%2112000035230390894%21sea%21US%210%21AB&amp;curPageLogUid=MM4l4xnyzX3a&amp;_gl=1*wxu29a*_ga*ODQ2MjE3MjYxLjE3MDEwMDU1OTc.*_ga_VED1YSGNC7*MTcwMTAwNTU5Ni4xLjAuMTcwMTAwNTU5Ni42MC4wLjA.">AliExpress</a>, which was as far as I can tell is a 2kW, low speed permanent magnet generator, available in various voltages such as 48V, 220V, 400V. See <a href="#tbl-pmg-specs" class="quarto-xref">Table&nbsp;9</a></p>
<div id="tbl-pmg-specs" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pmg-specs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Rewindagic generator specifications
</figcaption>
<div aria-describedby="tbl-pmg-specs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Model: PMG-2000L</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rated power</td>
<td style="text-align: left;">2000W</td>
</tr>
<tr class="even">
<td style="text-align: left;">Max power</td>
<td style="text-align: left;">2500W</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rated voltage</td>
<td style="text-align: left;">220v</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rated rotated speed</td>
<td style="text-align: left;">500 RPM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Start torque</td>
<td style="text-align: left;">0.74 Nm</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rated torque</td>
<td style="text-align: left;">16.4 Nm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Working temperature</td>
<td style="text-align: left;">-40 to 80 C</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Kris should have test this generator on a test stand, then mocked up the generator with the gear box and pulleys. I don’t know what he was expecting the water wheel rotational speed to be when he was doing the design, but 10 RPM at 120 lps seems about right to me. He needed a gear ratio of 10:500 or 1:50, but his inital design was a 1:20. Later he upped the gear ratio to 1:40.</p>
<p>Kris complained complained about the PMG overheating and could only make 1500 Watts for less than a minute before getting smoking hot. He also had difficulty getting the inverter and PMG to regulate the rotational speed of the water wheel, which may have promted him to change from 220 to 96 Volts. In part 3, Kris open the PMG case and measured the diamter of the wire in the windings and found it to be 0.7mm. There was some correspondence with the generator supplier and Kris concluded that the generator was improperly characterized and probably more like a 500 Watt generator rather than a 2kW generator.</p>
<p>Testing on a gernerator test stand, rather than on site infront of the customer, is always prefered. He would have determine if the Rewindagic generator would meet his needs. He designed the gear box and PMG mounting around an untested generator.</p>
<section id="thermal-calculations" class="level4" data-number="4.8.1.1">
<h4 data-number="4.8.1.1" class="anchored" data-anchor-id="thermal-calculations"><span class="header-section-number">4.8.1.1</span> Thermal calculations</h4>
<p>The following are some calculations to estimate the heat flow out of the PMG. The available power that can be delivered from the water wheel to the shaft of the generator at 120 lps is calculated below.</p>
<div id="cell-81" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="fl">2.1</span><span class="op">*</span>ureg.meter <span class="co"># head equal to the wheel diameter</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">120</span><span class="op">*</span>ureg.liter<span class="op">/</span>(<span class="dv">1</span><span class="op">*</span>ureg.sec)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>available_power_to_generator <span class="op">=</span> (rho<span class="op">*</span>g<span class="op">*</span>Q<span class="op">*</span>H<span class="op">*</span>eta_waterwheel<span class="op">*</span>eta_gear_box).to(<span class="st">'watt'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print('available power to generator: {:,.1f~P}'.format(available_power_to_generator))</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The available power to generator is {:,.1f~P}'</span>.<span class="bu">format</span>(available_power_to_generator))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="28">
<p>The available power to generator is 2,112.4 W</p>
</div>
</div>
<p>Assuming that the generator will convert avaliable power to electrical energy, then losses internal to the generator will produce heat.</p>
<div id="cell-83" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print('generator losses as heat: {:.1f~P}'.format((available_power_to_generator*(1-eta_generator)).to('watt')))</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The generator losses as heat based on efficiency are {:.1f~P}'</span>.<span class="bu">format</span>((available_power_to_generator<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>eta_generator)).to(<span class="st">'watt'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="29">
<p>The generator losses as heat based on efficiency are 211.2 W</p>
</div>
</div>
<p>There are three paths for the internal heat to exit the PMG body, by convection, radiation and conduction. The heat flow from from each of these paths is estimated based on using a maximum ambient temperature of 38C and a maximum allowed generator case temperature of 80C.</p>
</section>
<section id="convected-heat" class="level4" data-number="4.8.1.2">
<h4 data-number="4.8.1.2" class="anchored" data-anchor-id="convected-heat"><span class="header-section-number">4.8.1.2</span> Convected heat</h4>
<p>The heat convected from the PMG can be estimated by modeling the generator body as a horizontal cylinder with hemispheric end pieces. A simplified relation for natural convection heat transfer coefficient for a horizontal cylinder, was used from <span class="citation" data-cites="Cengel2002">Çengel (<a href="#ref-Cengel2002" role="doc-biblioref">2003</a>)</span>, Table 15-1. Also see example 15-10, page 816.</p>
<p>The formula for the heat transfer coefficient for a horizontal cylinder is:</p>
<p><span class="math inline">\(h_{conv}=1.32 {\frac {\Delta T}{D}}^{0.25}\)</span></p>
<p>where:<br>
<span class="math inline">\(h_{conv}\)</span> = heat transfer coefficient for a horizontal cylinder<br>
<span class="math inline">\(\Delta T\)</span> = difference in surface temperature and surrounding air<br>
<span class="math inline">\(D\)</span> = diameter of cylinder</p>
<p>The convected heat transfer is given by:</p>
<p><span class="math inline">\(Q_{conv}=h_{conv}A \Delta T\)</span></p>
<p>where:<br>
<span class="math inline">\(Q_{conv}\)</span> = convective heat transfer<br>
<span class="math inline">\(h_{conv}\)</span> = heat transfer coefficient<br>
<span class="math inline">\(A\)</span> = area of motor case<br>
<span class="math inline">\(\Delta T\)</span> = surface temperature with surrounding enviroment</p>
<p>Modeling the surface area of the generator as a cylinder with hemishpere end pieces. The diameter has been increased by 25% to account for radiating fins on the case.</p>
<div id="cell-85" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ureg <span class="op">=</span> pint.UnitRegistry(autoconvert_offset_to_baseunit <span class="op">=</span> <span class="va">True</span>) <span class="co"># allows for the conversion of temperatures</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>max_allowed_gen_case_temp <span class="op">=</span> <span class="dv">80</span><span class="op">*</span>ureg.degC</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>max_ambient_temp <span class="op">=</span> <span class="dv">38</span><span class="op">*</span>ureg.degC</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>delta_T <span class="op">=</span> max_allowed_gen_case_temp <span class="op">-</span> max_ambient_temp</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="fl">0.190</span><span class="op">*</span>ureg.meter <span class="co"># diameter of motor case</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> D<span class="op">+</span>D<span class="op">*</span><span class="fl">0.25</span> <span class="co"># adjust the diameter by 25% to account for radiating fins on the case</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">0.138</span><span class="op">*</span>ureg.meter <span class="co">#length of motor case</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.pi<span class="op">*</span>D<span class="op">*</span>L <span class="op">+</span> np.pi<span class="op">*</span>D<span class="op">**</span><span class="dv">2</span> <span class="co"># heat transfer surface of the generator (area of the cylinder plus end pieces)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>h_conv <span class="op">=</span> <span class="fl">1.32</span><span class="op">*</span>((delta_T.magnitude)<span class="op">/</span>(D.magnitude))<span class="op">**</span>(<span class="fl">0.25</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>Q_conv <span class="op">=</span> h_conv<span class="op">*</span>A.magnitude<span class="op">*</span>delta_T.magnitude</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#print('Q_conv: {:.2f}W'.format(Q_conv))</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The estimated convection heat flow is </span><span class="sc">{:.1f}</span><span class="st"> Watts.'</span>.<span class="bu">format</span>(Q_conv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="30">
<p>The estimated convection heat flow is 56.6 Watts.</p>
</div>
</div>
</section>
<section id="radiated-heat" class="level4" data-number="4.8.1.3">
<h4 data-number="4.8.1.3" class="anchored" data-anchor-id="radiated-heat"><span class="header-section-number">4.8.1.3</span> Radiated heat</h4>
<p>The heat transfer from radiation can be estimated from:</p>
<p><span class="math inline">\(Q_{rad}=\epsilon A_s \sigma (T_s^4 - T_{surr}^4)\)</span></p>
<p>where: <span class="math inline">\(Q_{rad}\)</span> = radiated heat transfer between the surface at temperature <span class="math inline">\(T_s\)</span> completely surrounded by a much larger surface at temperature <span class="math inline">\(T_{surr}\)</span><br>
<span class="math inline">\(\epsilon\)</span> = emissivity of the surface<br>
<span class="math inline">\(A_s\)</span> = surface area<br>
<span class="math inline">\(\sigma\)</span> = Stefan Boltzmann constant<br>
<span class="math inline">\(T_s\)</span> = surface temperature<br>
<span class="math inline">\(T_{surr}\)</span> = surrounding temperature</p>
<div id="cell-87" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>emissivity <span class="op">=</span> <span class="fl">0.85</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">5.67e-8</span> <span class="co"># Stefan-Blotzmann constant</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Q_rad <span class="op">=</span> emissivity<span class="op">*</span>A.magnitude<span class="op">*</span>alpha<span class="op">*</span>(max_allowed_gen_case_temp.to(<span class="st">'degK'</span>).magnitude<span class="op">**</span><span class="dv">4</span><span class="op">-</span>max_ambient_temp.to(<span class="st">'degK'</span>).magnitude<span class="op">**</span><span class="dv">4</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print('Q_rad: {:.2f}W'.format(Q_rad))</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The estimated radiated heat transfer is </span><span class="sc">{:.1f}</span><span class="st"> Watts'</span>.<span class="bu">format</span>(Q_rad))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="31">
<p>The estimated radiated heat transfer is 83.5 Watts</p>
</div>
</div>
</section>
<section id="heat-conduction-through-base" class="level4" data-number="4.8.1.4">
<h4 data-number="4.8.1.4" class="anchored" data-anchor-id="heat-conduction-through-base"><span class="header-section-number">4.8.1.4</span> Heat conduction through base</h4>
<p>There is heat transfer from the case to the frame through the mounting bracket.</p>
<p><span class="math inline">\(Q_{cond}=\frac {\Delta T}{R}\)</span></p>
<p>where:<br>
<span class="math inline">\(Q_{cond}\)</span> = cinducted heat transfer between mounting feet and frame<br>
<span class="math inline">\(\Delta T\)</span> = surface temperature with surrounding enviroment<br>
<span class="math inline">\(R\)</span> = thermal resistance of generator base to frame</p>
<p>The thermal resistance through the PMG mouting feet to the water wheel frame is estimated to be 10 Ohms.</p>
<div id="cell-89" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>R_thermal <span class="op">=</span> <span class="dv">10</span> <span class="co"># a guess</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Q_cond <span class="op">=</span> delta_T.magnitude<span class="op">/</span>R_thermal</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print('Q_cond: {:.2f}W'.format(Q_cond))</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The estimated conducted heat transfer is </span><span class="sc">{:.1f}</span><span class="st"> Watts.'</span>.<span class="bu">format</span>(Q_cond))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="32">
<p>The estimated conducted heat transfer is 4.2 Watts.</p>
</div>
</div>
<div id="cell-90" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>total_heat_out <span class="op">=</span> Q_conv<span class="op">+</span>Q_rad<span class="op">+</span>Q_cond</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print('total heat transfered from the generator body to the enviroment: {:.1f} Watts'.format(total_heat_out))</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The total heat transfered from the generator body is the sum of the heat flow from the three paths, so </span><span class="ch">\</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">the total heat transfered from the generator body to the enviroment is </span><span class="sc">{:.1f}</span><span class="st"> Watts.'</span>.<span class="bu">format</span>(total_heat_out))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="33">
<p>The total heat transfered from the generator body is the sum of the heat flow from the three paths, so the total heat transfered from the generator body to the enviroment is 144.3 Watts.</p>
</div>
</div>
<div id="cell-91" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>generator_losses_as_heat <span class="op">=</span> (rho<span class="op">*</span>g<span class="op">*</span>Q<span class="op">*</span>H<span class="op">*</span>eta_waterwheel<span class="op">*</span>eta_gear_box<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>eta_generator)).to(<span class="st">'watt'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The generator produces heat internally from the winding and core losses of {:.1f~P}'</span>.<span class="bu">format</span>(generator_losses_as_heat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="34">
<p>The generator produces heat internally from the winding and core losses of 211.2 W</p>
</div>
</div>
<div id="cell-92" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The net generator heat flow is </span><span class="sc">{:.1f}</span><span class="st"> Watts.'</span>.<span class="bu">format</span>(total_heat_out <span class="op">-</span> generator_losses_as_heat.magnitude))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="35">
<p>The net generator heat flow is -66.9 Watts.</p>
</div>
</div>
<p>Since the net heat flow is negative, the generator will heat up.</p>
<div id="cell-94" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ureg <span class="op">=</span> pint.UnitRegistry(autoconvert_offset_to_baseunit <span class="op">=</span> <span class="va">False</span>) <span class="co"># change back to more strict unit checking</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="why-did-the-pmg-generator-get-hot" class="level4" data-number="4.8.1.5">
<h4 data-number="4.8.1.5" class="anchored" data-anchor-id="why-did-the-pmg-generator-get-hot"><span class="header-section-number">4.8.1.5</span> Why did the PMG generator get hot?</h4>
<ul>
<li>inverter could have been in constant voltage mode with shaft to load power missmatch, wheel was spining too fast</li>
<li>The difference between available power and displayed power on the inverter was 1000 W, was that difference being dissipated as heat?</li>
<li>needed more testing to verify Kris’s complaints about the genertor, because he swapped out a 500 RPM device for a 750 RPM device w/o changing the gear box</li>
</ul>
<p>PMG winding wire diameter of 0.7 mm is probably on the low side for the 5 amps per phase calculated from the LTSpice circuit simulation of the generator windings, bridge recifier and resistive load.</p>
</section>
</section>
<section id="self-excited-induction-generator-seig" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="self-excited-induction-generator-seig"><span class="header-section-number">4.8.2</span> Self-excited induction generator (SEIG)</h3>
<p>The third generator tried was a 2.2kW, 8 pole, induction generator from <a href="https://tecmotors.co.uk/products/motors/three-phase/aluminium-motors/ms/2-2kw-8-pole-foot-mounted-motor-b3-ie1-2-283tecab3/">Tec Motors</a>. This device as a motor, will make the rated power at 720 RPM. In video part 4 at time 0:51, the details on the motor face plate can be seen. See <a href="#tbl-seig-specs" class="quarto-xref">Table&nbsp;10</a></p>
<div id="tbl-seig-specs" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-seig-specs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Tec Motor generator specifications
</figcaption>
<div aria-describedby="tbl-seig-specs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Motor part code</td>
<td style="text-align: left;">2.283TECAB3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frame size</td>
<td style="text-align: left;">132S-8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Output</td>
<td style="text-align: left;">2.2 kW</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rotational Speed</td>
<td style="text-align: left;">720 RPM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Voltage</td>
<td style="text-align: left;">230/400</td>
</tr>
<tr class="even">
<td style="text-align: left;">Full Load Current</td>
<td style="text-align: left;">10.32 | 5.96 A</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Full Load Torque</td>
<td style="text-align: left;">29.180555 Nm</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>While the use of an induction generator is an acceptable choice, there some differences in the operation of a Self Exicted Induction Generator (SEIG). For this hydro project the primary differences are the use of capacitors across each phase to supply reactive power back to the generator, this assume that the rotor has some residual magnetism. The SEIG is physically larger and required modifications to the mounting block and weather/splash cover. The SEIG has a higher RPM than the old PMG and the gear box ratio needs to be changed to something in the area of 1:80.</p>
<p>An analysis of the SEIG will not be included in this version of my notebook. In a future version, the proposed topics are:</p>
<ul>
<li>use of a SEIG, pros and cons</li>
<li>capacitor value calculation</li>
<li>heat transfer</li>
<li>use of MPP and PV inverters</li>
<li>gear ratio</li>
</ul>
</section>
</section>
<section id="the-flume" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="the-flume"><span class="header-section-number">4.9</span> The flume</h2>
<div id="fig-video_Screenshot_6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-video_Screenshot_6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="video_Screenshot_6.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-video_Screenshot_6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The flume
</figcaption>
</figure>
</div>
<p><a href="#fig-video_Screenshot_6" class="quarto-xref">Figure&nbsp;10</a> was taken from part 4 of the series and shows a view of the flume after modifications were made to round the corner of the turn. You can see that the depth of the water in the flume is about 50 mm or so and that the flow rate is somewhat high since there is turbulance observed in the flow. Kris complained that wheel was turning too fast and that the generter and inverter were not slowing the wheel rotation rate. There was significant anount of splashing of the water as it entered the buckets and he built a nozzel help guide the water to the buckets. He did not address the velocity of the water compared to the tangential velocity of the wheel nor the flow rate requirements of the flume or the flume design.</p>
<p>The <a href="https://www.merriam-webster.com/dictionary/flume">flume</a> carries water from the dam to the top of the waterwheel. By examining the videos, I made some estimates for the flume dimensions. The width of the flume was about the same width of the waterwheel, which makes sense, since you want an even flow of water into the buckets. The side walls of the flume looked like 150 mm high, so this would be the maximum depth of water the could flow through the flume.</p>
<p>I can use the Manning equation for open channel flow to calculate the flow rate in the flume. <a href="https://en.wikipedia.org/wiki/Manning_formula">Mannings equation</a> is an empirical equation that applies to uniform flow in open channels and is a function of the channel velocity, flow area and channel slope.</p>
<p><span class="math inline">\(V = \frac {s^{1/2} \times R^{2/3}} {n}\)</span></p>
<p>where:</p>
<p>V - water velocity<br>
n - Manning’s roughness coefficient; <a href="https://www.engineeringtoolbox.com/mannings-roughness-d_799.html">unplaned wood</a> = 0.013, wood sides and smooth sheet metal bottom<br>
R - The channel’s hydraulic radius, calculated by dividing the water flow’s cross-sectional area A by its wetted perimeter P<br>
s - Slope of the channel’s bottom surface</p>
<p>Examining Manning’s equation, we can see that the area and slope are directly proportional to the water flow rate, which means an increase in area and slope would increase the water flow rate. On the other hand, the roughness coefficient and the wetted perimeter are inversely proportional to the water flow rate, meaning that increasing their values would decrease the water flow rate.</p>
<section id="flume-slope" class="level3" data-number="4.9.1">
<h3 data-number="4.9.1" class="anchored" data-anchor-id="flume-slope"><span class="header-section-number">4.9.1</span> Flume slope</h3>
<p>In <span class="citation" data-cites="Kris2023Survey">Harbour (<a href="#ref-Kris2023Survey" role="doc-biblioref">2023</a>)</span>, Kris proided some information about the length and slope of the flume. In the survey he stated:</p>
<blockquote class="blockquote">
<p>Because this has to be quite long (approximately 8 meters) there needs to be a downward slope in order to keep the water flowing. I have made this slope 1 degree and it equates to a 300mm level change.</p>
</blockquote>
<p>Doing the math to calculate the slope and level change:</p>
<div id="cell-97" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>flume_length <span class="op">=</span> <span class="dv">8</span><span class="op">*</span>ureg.meter</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>flume_drop <span class="op">=</span> <span class="dv">300</span><span class="op">*</span>ureg.mm</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>flume_drop.ito(<span class="st">'meter'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print('angle of slope: {:.2f}'.format(np.arctan(flume_drop/flume_length).to('degree')))</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The angle of slope is </span><span class="sc">{:.2f}</span><span class="st">s.'</span>.<span class="bu">format</span>(np.arctan(flume_drop<span class="op">/</span>flume_length).to(<span class="st">'degree'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="37">
<p>The angle of slope is 2.15 degrees.</p>
</div>
</div>
<p>The math works out to about 2 degrees.</p>
<div id="cell-99" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>flume_slope <span class="op">=</span> flume_drop.magnitude<span class="op">/</span>flume_length.magnitude</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print('flume slope: {:.1f}%'.format(flume_slope*100))</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The flume slope is </span><span class="sc">{:.1f}</span><span class="st">%.'</span>.<span class="bu">format</span>(flume_slope<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="38">
<p>The flume slope is 3.8%.</p>
</div>
</div>
<p>So which is it, 1 degree or 300mm drop?</p>
<p>In the project survey, Kris goes through the verticle dimentions of the available head.</p>
<blockquote class="blockquote">
<p>There is a drop of 2.6m from the top of the dam to the point that the outlet stream bed levels out.</p>
</blockquote>
<blockquote class="blockquote">
<p>The total head is 2.6m. Because the wheel has to be sited further down hill than the dam, there needs to be a water trough feeding the wheel. Because this has to be quite long (approximately 8 meters) there needs to be a downward slope in order to keep the water flowing. I have made this slope 1 degree and it equates to a 300mm level change. This brings the head down to 2.3m there needs to be a gap between the feed trough and the top of the wheel and this gap is 100mm. This leaves 200mm of head left. The waterwheel can’t touch the water at the bottom or it will cause drag so we need a gap there of at least 100mm now we are down to 2.1m and then I have allowed a 100mm tolerance so a 2m wheel is the correct size for this site. Though the wheel is now only 2m the other 0.5m of head is not completely lost. That 0.5m of head the water is still falling and gaining speed in the trough so the 0.5m head is not lost it is just susceptible to some friction losses in the trough.</p>
</blockquote>
<p>subtractions:</p>
<ul>
<li>300 mm for the flume</li>
<li>100 mm gap between top of wheel and flume</li>
<li>100 mm gap at tbottem of wheel</li>
<li>100 mm tolerance</li>
</ul>
<p>Here he states that the wheel of 2m is the correct size. However, eariler in the videos, he stated the wheel is 2.1 m in diameter. So a diameter of 2.1 m was used in the calculations above. Since Kris went through the gaps and tolerances to size the water wheel diameter, I’m going to assume that the slope is 0.3 meters divided by 8 meters or 3.8% and not 1 degree.</p>
<div class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flume calculations using Manning equation</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>flume_width <span class="op">=</span> <span class="dv">800</span><span class="op">*</span>ureg.mm</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>water_depth <span class="op">=</span> <span class="dv">70</span><span class="op">*</span>ureg.mm <span class="co"># estimated depth of the water in the flume</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to base units</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>flume_width.ito(<span class="st">'meter'</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>water_depth.ito(<span class="st">'meter'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>water_cross_section_area <span class="op">=</span> water_depth<span class="op">*</span>flume_width</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>wetted_perimeter <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>water_depth<span class="op">+</span>flume_width</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>hydraulic_radius <span class="op">=</span> water_cross_section_area<span class="op">/</span>wetted_perimeter</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>roughness_coefficient <span class="op">=</span> <span class="fl">0.013</span> <span class="co"># Wood - unplaned</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>slope <span class="op">=</span> flume_slope</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># need to use magnitude of quantity when using fractional exponents</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>water_flume_velocity <span class="op">=</span> (((hydraulic_radius.magnitude)<span class="op">**</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>slope<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>roughness_coefficient)<span class="op">*</span>ureg.meter<span class="op">/</span>ureg.sec</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>volumetric_flow_rate <span class="op">=</span> water_flume_velocity<span class="op">*</span>water_cross_section_area</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Calculation'</span>, <span class="st">'Result'</span>]</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Water cross section area'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(water_cross_section_area)])</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Wetted perimeter'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(wetted_perimeter)])</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Hydraulic radius'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(hydraulic_radius)])</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Slope'</span>, <span class="st">'</span><span class="sc">{:.1f}</span><span class="st">%'</span>.<span class="bu">format</span>(slope<span class="op">*</span><span class="dv">100</span>)])</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Water flume velocity'</span>, <span class="st">'{:.1f~P}'</span>.<span class="bu">format</span>(water_flume_velocity)])</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Volumetric flow rate'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(volumetric_flow_rate)])</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Volumetric flow rate'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(volumetric_flow_rate.to(<span class="st">'liter/sec'</span>))])</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-flume-calculations" class="cell quarto-float anchored" data-execution_count="39">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-flume-calculations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Flume calculations using Manning equation
</figcaption>
<div aria-describedby="tbl-flume-calculations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="39">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Calculation</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Water cross section area</td>
<td style="text-align: left;">0.06 m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wetted perimeter</td>
<td style="text-align: left;">0.94 m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hydraulic radius</td>
<td style="text-align: left;">0.06 m</td>
</tr>
<tr class="even">
<td style="text-align: left;">Slope</td>
<td style="text-align: left;">3.8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Water flume velocity</td>
<td style="text-align: left;">2.3 m/s</td>
</tr>
<tr class="even">
<td style="text-align: left;">Volumetric flow rate</td>
<td style="text-align: left;">0.13 m³/s</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Volumetric flow rate</td>
<td style="text-align: left;">127.24 l/s</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--
print('Flume calculation results')
flume_width = 800*ureg.mm
water_depth = 70*ureg.mm # estimated depth of the water in the flume
# convert to base units
flume_width.ito('meter')
water_depth.ito('meter')
water_cross_section_area = water_depth*flume_width
print('water_cross_section_area = {:.4f~P}'.format(water_cross_section_area))
wetted_perimeter = 2*water_depth+flume_width
print('wetted_perimeter = {:.4f~P}'.format(wetted_perimeter))
hydraulic_radius = water_cross_section_area/wetted_perimeter
print('hydraulic_radius = {:.4f~P}'.format(hydraulic_radius))
roughness_coefficient = 0.013 # Wood - unplaned
slope = flume_slope
print('slope = {:.4f}'.format(slope))
# need to use magnitude of quantity when using fractional exponents
water_flume_velocity = (((hydraulic_radius.magnitude)**(2/3)*slope**(1/2))/roughness_coefficient)*ureg.meter/ureg.sec
print('water_flume_velocity = {:.4f~P}'.format(water_flume_velocity))
volumetric_flow_rate = water_flume_velocity*water_cross_section_area
print('volumetric_flow_rate = {:.6f~P}'.format(volumetric_flow_rate))
print('volumetric_flow_rate = {:.2f~P}'.format(volumetric_flow_rate.to('liter/sec')))
-->
<p>The values calculated by Manning’s equation are estimates, so we should get too hung up on the magnitudes, but the these numbers can serve as a guide to what’s happing in the flume. Given the roughness coefficient and slope, the water velocity is above 2 m/s and in the videos, the water at high flow rates is moving fast. The velocity of the water definately exceeds the tangential velocity of the water wheel and it is appearent in the videos that lots of water is slpashing out of the buckets when Kris tries to run the hydro system at full power. Some adjustments to the flume are needed.</p>
</section>
<section id="flume-re-design" class="level3" data-number="4.9.2">
<h3 data-number="4.9.2" class="anchored" data-anchor-id="flume-re-design"><span class="header-section-number">4.9.2</span> Flume re-design</h3>
<p>To avoid a total rebuild of the flume, some modifications could be made to decrease the flow velocity while maintaing the desired flow rate. The slope of the flume is kept, since the slope would be hard to change. The inlet depth would need to be increased to allow a deeper flow and baffles or corrugated surface could be installed to line the bottem channel of the flume. This would cause some energy dissipation and slow the flow characteristics. In the calculations below the water depth and roughness coefficient were adjusted. Modifications to the flume surface roughness would need to proceed by trial and error until the right combination of water depth and surface roughness yeilds the desired flow velocity and volume.</p>
<p>The inlet to the flume is adjust to bring the depth in the flume channel up to 150mm. The inlet level to the spillway might need to be raised and along with the flume side walls to rase the level of water entering the flume. The surface roughness coefficient needs to be increased by adding baffles. The calculations below produce a flow velocity of 1 m/s and a volume of 132 l/s.</p>
<div class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>flume_width <span class="op">=</span> <span class="dv">800</span><span class="op">*</span>ureg.mm</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>water_depth <span class="op">=</span> <span class="dv">150</span><span class="op">*</span>ureg.mm</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to base units</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>flume_width.ito(<span class="st">'meter'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>water_depth.ito(<span class="st">'meter'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>water_cross_section_area <span class="op">=</span> water_depth<span class="op">*</span>flume_width</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>wetted_perimeter <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>water_depth<span class="op">+</span>flume_width</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>hydraulic_radius <span class="op">=</span> water_cross_section_area<span class="op">/</span>wetted_perimeter</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>roughness_coefficient <span class="op">=</span> <span class="fl">0.04</span> <span class="co"># increased by adding baffles</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>slope <span class="op">=</span> flume_slope</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># need to use magnitude of quantity when using fractional exponents</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>water_flume_velocity <span class="op">=</span> (((hydraulic_radius.magnitude)<span class="op">**</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>slope<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>roughness_coefficient)<span class="op">*</span>ureg.meter<span class="op">/</span>ureg.sec</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>volumetric_flow_rate <span class="op">=</span> water_flume_velocity<span class="op">*</span>water_cross_section_area</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Calculation'</span>, <span class="st">'Result'</span>]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Water cross section area'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(water_cross_section_area)])</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Wetted perimeter'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(wetted_perimeter)])</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Hydraulic radius'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(hydraulic_radius)])</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Slope'</span>, <span class="st">'</span><span class="sc">{:.1f}</span><span class="st">%'</span>.<span class="bu">format</span>(slope<span class="op">*</span><span class="dv">100</span>)])</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Water flume velocity'</span>, <span class="st">'{:.1f~P}'</span>.<span class="bu">format</span>(water_flume_velocity)])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Volumetric flow rate'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(volumetric_flow_rate)])</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>table_row.append([<span class="st">'Volumetric flow rate'</span>, <span class="st">'{:.2f~P}'</span>.<span class="bu">format</span>(volumetric_flow_rate.to(<span class="st">'liter/sec'</span>))])</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-flume-redesign" class="cell quarto-float anchored" data-execution_count="40">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-flume-redesign-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Flume redesign
</figcaption>
<div aria-describedby="tbl-flume-redesign-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="40">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Calculation</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Water cross section area</td>
<td style="text-align: left;">0.12 m²</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wetted perimeter</td>
<td style="text-align: left;">1.10 m</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hydraulic radius</td>
<td style="text-align: left;">0.11 m</td>
</tr>
<tr class="even">
<td style="text-align: left;">Slope</td>
<td style="text-align: left;">3.8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Water flume velocity</td>
<td style="text-align: left;">1.1 m/s</td>
</tr>
<tr class="even">
<td style="text-align: left;">Volumetric flow rate</td>
<td style="text-align: left;">0.13 m³/s</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Volumetric flow rate</td>
<td style="text-align: left;">132.64 l/s</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--
print('water_cross_section_area = {:.4f~P}'.format(water_cross_section_area))
print('wetted_perimeter = {:.4f~P}'.format(wetted_perimeter))
print('hydraulic_radius = {:.4f~P}'.format(hydraulic_radius))
print('slope = {:.4f}'.format(slope))
print('water_flume_velocity = {:.4f~P}'.format(water_flume_velocity))

print('volumetric_flow_rate = {:.6f~P}'.format(volumetric_flow_rate))
print('volumetric_flow_rate = {:.2f~P}'.format(volumetric_flow_rate.to('liter/sec')))


print('Flume calculation results')
flume_width = 800*ureg.mm
water_depth = 150*ureg.mm
# convert to base units
flume_width.ito('meter')
water_depth.ito('meter')
water_cross_section_area = water_depth*flume_width
print('water_cross_section_area = {:.4f~P}'.format(water_cross_section_area))
wetted_perimeter = 2*water_depth+flume_width
print('wetted_perimeter = {:.4f~P}'.format(wetted_perimeter))
hydraulic_radius = water_cross_section_area/wetted_perimeter
print('hydraulic_radius = {:.4f~P}'.format(hydraulic_radius))
roughness_coefficient = 0.04 # increased by adding baffles
slope = flume_slope
print('slope = {:.4f}'.format(slope))
# need to use magnitude of quantity when using fractional exponents
water_flume_velocity = (((hydraulic_radius.magnitude)**(2/3)*slope**(1/2))/roughness_coefficient)*ureg.meter/ureg.sec
print('water_flume_velocity = {:.4f~P}'.format(water_flume_velocity))
volumetric_flow_rate = water_flume_velocity*water_cross_section_area
print('volumetric_flow_rate = {:.6f~P}'.format(volumetric_flow_rate))
print('volumetric_flow_rate = {:.2f~P}'.format(volumetric_flow_rate.to('liter/sec')))
-->
</section>
</section>
</section>
<section id="safety" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Safety</h1>
<p>Kris didn’t discuss any safety criteria that was part of the design effort. He did talk about how his responsibility was primarily for the wheel itself and that the owner had arrange for the work for the construction of the flume, mill pond and spillway. Kris also mentioned that a qualified electrition would be responcible for some of the wiring and implied also that the grid tie connection part would be taken care of.</p>
<p>The uncontrolled discharge of surplus water past the dam should be automatic and not dependent upon human control. The spillway intake should be large enough to discharge a volume of water during floods without increasing the water level in the mill pod and causing problems upstream. In the project survey he states:</p>
<blockquote class="blockquote">
<p>Because of this we need to install and bypass drain from the mill pond around the bridge. This would outlet back in the the stream. This overflow will be set a a hight that it will start to drain and bypass water once the wheel has its full volume. There will also be a basic gate to control this flow rate manually. The nature of the land that this bypass is sited within is very difficult to model in 3d. It needs to have a slope to it and has to have at least one change in direction. For this I would recommend at least 500mm wide by 400mm high square channel.</p>
</blockquote>
<p>He provied no rational to support his assursion that a 500mm by 400mm square channel would be sufficient.</p>
<p>Given that the primary fococus of the four videos was about the construction of the water wheel and not about its design, it’s understandable that safety was not discussed too much.</p>
</section>
<section id="maintenance" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Maintenance</h1>
<p>Kris didn’t discuss the topic of maintenance of any of the components of the hydro project. This would include the water wheel, water wheel bearings, gear box, generator and associated electronics. There is probably some small level of maintenace and inspections required for the leat, mill pond, flume and spillway. Kris didn’t discuss his selection critiera or specifications for those items that would experience a high moisture operating enviroment. One thing that comes to mind is that the generator didn’t seem like it was indented to be used outdoors, even if it was under a cover.</p>
</section>
<section id="economic-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Economic analysis</h1>
<p>This project was done in the UK, so I looked up electrical rates for the region in the UK I think this project was located. The power usage on the property was never discussed, for the economic analysis I’m going to assume that 700 Watts is the average load. The hydro system is planned to generate 1500 Watt 24 hours per day. The time frame for the economic analysis is 15 years. 15 years was chosen because this amount of time seemed reasonalble to evaluate the yearly cash flow for the project. The initial cost for construction and materials would be included in the first year’s cash flow. Cash flows for subsequent years would include maintenace averaged per year along with the cash received for any net power production for the year.</p>
<p>In the 5th video, at time 13:07, Kris showed the data from the inverter. Total yield reported on that day was 479kWh for earnings of 134.12 GBP. I’m going to use 28p/kWh for electricity rate and the same for the net meter rate.</p>
<div id="tbl-econ-anal" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-econ-anal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Parameters for economic analysis
</figcaption>
<div aria-describedby="tbl-econ-anal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<tbody>
<tr class="odd">
<td>electricity rate</td>
<td>£0.28</td>
</tr>
<tr class="even">
<td>net meter rate</td>
<td>£0.28</td>
</tr>
<tr class="odd">
<td>average load</td>
<td>500 W</td>
</tr>
<tr class="even">
<td>average power generated</td>
<td>1000 W</td>
</tr>
<tr class="odd">
<td>time frame for the economic analysis</td>
<td>15 years</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>See table <a href="#tbl-econ-anal" class="quarto-xref">Table&nbsp;13</a></p>
<div id="cell-108" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>house_pwr_usage <span class="op">=</span> <span class="dv">700</span><span class="op">*</span>ureg.watt</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>meter_rate <span class="op">=</span> (<span class="fl">134.12</span><span class="op">/</span><span class="dv">479</span>)<span class="op">/</span>(<span class="dv">1000</span><span class="op">*</span>ureg.Wh)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>house_yearly_energy_usage_cost <span class="op">=</span> <span class="dv">365</span><span class="op">*</span><span class="dv">24</span><span class="op">*</span>ureg.hr<span class="op">*</span>house_pwr_usage<span class="op">*</span>meter_rate</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The hydro system is planned to generate electrical power 24 hours per day and this project was done in the UK. In the 5th video, </span><span class="ch">\</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">at time 13:07, Kris showed the data from the inverter,some of which I</span><span class="ch">\'</span><span class="st">ll use in my analysis. I</span><span class="ch">\'</span><span class="st">m going to use </span><span class="ch">\u00a3</span><span class="sc">{:.3f}</span><span class="st">/kWh for electricity </span><span class="ch">\</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">rate and the same for the net meter rate. The power usage on the property was never discussed, for the economic analysis I</span><span class="ch">\'</span><span class="st">m going </span><span class="ch">\</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">to assume that </span><span class="sc">{:.0f}</span><span class="st"> Watts is the average load. The house daily energy usage is </span><span class="sc">{:,.0f}</span><span class="st"> and the daily energy usage cost </span><span class="ch">\</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">is </span><span class="ch">\u00a3</span><span class="sc">{:.2f}</span><span class="st">. The annual energy cost is </span><span class="ch">\u00a3</span><span class="sc">{:,.2f}</span><span class="st">.'</span>.<span class="bu">format</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>(meter_rate<span class="op">*</span><span class="dv">1000</span>).magnitude,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>house_pwr_usage.magnitude,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>(<span class="dv">24</span><span class="op">*</span>ureg.hr<span class="op">*</span>house_pwr_usage).magnitude,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>(<span class="dv">24</span><span class="op">*</span>ureg.hr<span class="op">*</span>house_pwr_usage<span class="op">*</span>meter_rate).to_base_units().magnitude,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>house_yearly_energy_usage_cost.to_base_units().magnitude))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="41">
<p>The hydro system is planned to generate electrical power 24 hours per day and this project was done in the UK. In the 5th video, at time 13:07, Kris showed the data from the inverter,some of which I’ll use in my analysis. I’m going to use £0.280/kWh for electricity rate and the same for the net meter rate. The power usage on the property was never discussed, for the economic analysis I’m going to assume that 700 Watts is the average load. The house daily energy usage is 16,800 and the daily energy usage cost is £4.70. The annual energy cost is £1,716.96.</p>
</div>
</div>
<p>The time frame for the economic analysis is 15 years. 15 years was chosen because this amount of time seemed reasonalble to evaluate the yearly cash flow for the project. The initial cost for construction and materials would be included in the first year’s cash flow. Cash flows for subsequent years would include maintenace averaged per year along with the cash received for any net power production for the year.</p>
<!--
house_pwr_usage = 700*ureg.watt
meter_rate = (134.12/479)/(1000*ureg.Wh)
print('house daily energy usage: {:,.0f~P}'.format((24*ureg.hr*house_pwr_usage).to('Wh')))
print('house daily energy usage cost: \u00a3{:.2f}'.format((24*ureg.hr*house_pwr_usage*meter_rate).to_base_units().magnitude))
house_yearly_energy_usage_cost = 365*24*ureg.hr*house_pwr_usage*meter_rate
print('house yearly energy usage cost: \u00a3{:,.2f}'.format(house_yearly_energy_usage_cost.to_base_units().magnitude))
-->
<p>Since the water wheel is generating more power than needed, the cost saved per year is equal to the cost of electrical energy consumed.</p>
<div id="cell-112" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>saved_cost_yr <span class="op">=</span> house_yearly_energy_usage_cost</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print('cost saved per year: \u00a3{:,.2f}'.format(saved_cost_yr.to_base_units().magnitude))</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The net energy used per day is the generated energy per day minus the daily energy usage, </span><span class="ch">\</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">so the cost saved per year is </span><span class="ch">\u00a3</span><span class="sc">{:,.2f}</span><span class="st">.'</span>.<span class="bu">format</span>(saved_cost_yr.to_base_units().magnitude))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="42">
<p>The net energy used per day is the generated energy per day minus the daily energy usage, so the cost saved per year is £1,716.96.</p>
</div>
</div>
<div id="cell-113" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>generated_pwr <span class="op">=</span> <span class="dv">1000</span><span class="op">*</span>ureg.watts</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>net_pwr_usage <span class="op">=</span> generated_pwr <span class="op">-</span> house_pwr_usage</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>net_energy_day <span class="op">=</span> <span class="dv">24</span><span class="op">*</span>ureg.hour<span class="op">*</span>net_pwr_usage</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print('net energy per day: {:,.0f~P}'.format(net_energy_day))</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'I</span><span class="ch">\'</span><span class="st">m going to set the daily average to 1kW, since this is what Kris seemed to imply in part 5 of the series. </span><span class="ch">\</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="st">The net energy used per day is {:,.0f~P}.'</span>.<span class="bu">format</span>(net_energy_day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="43">
<p>I’m going to set the daily average to 1kW, since this is what Kris seemed to imply in part 5 of the series. The net energy used per day is 7,200 W·h.</p>
</div>
</div>
<div id="cell-114" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>net_meter_rate <span class="op">=</span> meter_rate <span class="co">#0.30/(1000*ureg.Wh) #avg_net_meter_rate/((1000*ureg.Wh)) # amount per kWh</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>net_meter_credit_yr <span class="op">=</span> (<span class="dv">365</span><span class="op">*</span>net_energy_day<span class="op">*</span>net_meter_rate).to_base_units()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'In this analysis I</span><span class="ch">\'</span><span class="st">m going to use </span><span class="ch">\u00a3</span><span class="sc">{:.2f}</span><span class="st"> per kWh for the net meter rate. </span><span class="ch">\</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="st">The net meter credit would be </span><span class="ch">\u00a3</span><span class="sc">{:,.2f}</span><span class="st"> per day and </span><span class="ch">\u00a3</span><span class="sc">{:,.2f}</span><span class="st"> per year.'</span>.<span class="bu">format</span>(net_meter_rate.magnitude<span class="op">*</span><span class="dv">1000</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>(net_energy_day<span class="op">*</span>net_meter_rate).to_base_units().magnitude, net_meter_credit_yr.magnitude))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="44">
<p>In this analysis I’m going to use £0.28 per kWh for the net meter rate. The net meter credit would be £2.02 per day and £735.84 per year.</p>
</div>
</div>
<p>The number of years for this economic analysis is 15 years. This is the time frame that the <a href="https://en.wikipedia.org/wiki/Internal_rate_of_return">internal rate of return</a> will be calculated for. The internal rate of return is a method of quantifying the merits of a project or investment opportunity. The calculation is termed internal because it depends only on the cash flows of the investment being analyzed and excludes external factors, such as returns available elsewhere, the risk-free rate, inflation, the cost of capital, or financial risk.</p>
<div id="cell-116" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> irr(values, guess<span class="op">=</span><span class="va">None</span>, tol<span class="op">=</span><span class="fl">1e-12</span>, maxiter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Return the Internal Rate of Return (IRR).</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">    This is the "average" periodically compounded rate of return</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">    that gives a net present value of 0.0; for a more complete explanation,</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">    see Notes below.</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :class:`decimal.Decimal` type is not supported.</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">    values : array_like, shape(N,)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Input cash flows per time period.  By convention, net "deposits"</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">        are negative and net "withdrawals" are positive.  Thus, for</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">        example, at least the first element of `values`, which represents</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">        the initial investment, will typically be negative.</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">    guess : float, optional</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">        Initial guess of the IRR for the iterative solver. If no guess is</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">        given an heuristic is used to estimate the guess through the ratio of</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">        positive to negative cash lows</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">    tol : float, optional</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Required tolerance to accept solution. Default is 1e-12.</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">    maxiter : int, optional</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Maximum iterations to perform in finding a solution. Default is 100.</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co">    out : float</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co">        Internal Rate of Return for periodic input values.</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> np.atleast_1d(values)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> values.ndim <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Cashflows must be a rank-1 array"</span>)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If all values are of the same sign no solution exists</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we don't perform any further calculations and exit early</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    same_sign <span class="op">=</span> np.<span class="bu">all</span>(values <span class="op">&gt;</span> <span class="dv">0</span>) <span class="cf">if</span> values[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.<span class="bu">all</span>(values <span class="op">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> same_sign:</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If no value is passed for `guess`, then make a heuristic estimate</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> guess <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>        positive_cashflow <span class="op">=</span> values <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>        inflow <span class="op">=</span> values.<span class="bu">sum</span>(where<span class="op">=</span>positive_cashflow)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>        outflow <span class="op">=</span> <span class="op">-</span>values.<span class="bu">sum</span>(where<span class="op">=~</span>positive_cashflow)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>        guess <span class="op">=</span> inflow <span class="op">/</span> outflow <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    npv_ <span class="op">=</span> np.polynomial.Polynomial(values[::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    d_npv <span class="op">=</span> npv_.deriv()</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> guess</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(maxiter):</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>        delta <span class="op">=</span> npv_(g) <span class="op">/</span> d_npv(g)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(delta) <span class="op">&lt;</span> tol:</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> g <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>        g <span class="op">-=</span> delta</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.nan</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>construction_cost <span class="op">=</span> <span class="dv">20000</span> <span class="co"># who knows?</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>maintenance_cost <span class="op">=</span> <span class="dv">200</span> <span class="co"># per year</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>years_to_analyze <span class="op">=</span> <span class="dv">15</span> <span class="co"># years</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>cash_flow_each_year <span class="op">=</span> np.ones(years_to_analyze)<span class="op">*</span>(saved_cost_yr<span class="op">+</span>net_meter_credit_yr<span class="op">-</span>maintenance_cost).magnitude</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a><span class="co"># include construction cost in 1st year</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>cash_flow_each_year[<span class="dv">0</span>] <span class="op">=</span> cash_flow_each_year[<span class="dv">0</span>]<span class="op">-</span>construction_cost</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="co">#cash_flow_each_year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The construction cost of the hydro system was never discussed and some of the work was done by friends and family. Just taking a wild guesss and using £20000 for the materials and construction cost and a average yearily maintence cost of £200 (also a guess), the internal rate of return can be calculated over the estimated cash flows for 15 years.</p>
<div id="cell-118" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print('internal rate of return: {:.1f}%'.format(irr(cash_flow_each_year)*100))</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'Using the parameters stated above, the IRR works out to be </span><span class="sc">{:.1f}</span><span class="st">%, which indicates that the ROI is favorable. </span><span class="ch">\</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">The IRR is highly senditive to the electrical power rates, for both received and generated power and the net energy useage.'</span>.<span class="bu">format</span>(irr(cash_flow_each_year)<span class="op">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="46">
<p>Using the parameters stated above, the IRR works out to be 8.8%, which indicates that the ROI is favorable. The IRR is highly senditive to the electrical power rates, for both received and generated power and the net energy useage.</p>
</div>
</div>
</section>
<section id="summary" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Summary</h1>
<p>critical aspects to get right</p>
<ul>
<li>feasability, including econmics<br>
</li>
<li>project management steps:
<ol type="1">
<li>requirement review</li>
<li>preliminary design review</li>
<li>testing of proto type</li>
<li>critical design review</li>
<li>intallation and final testing<br>
</li>
</ol></li>
<li>design and selection of generator, gear box and inverter combination<br>
</li>
<li>flume leat, dam and spillway design<br>
</li>
<li>wheel design<br>
</li>
<li>provisions for adjusting the gearbox ratio post install</li>
<li>enviromental requirements (high moisture enviroment, operating temperature ranges, possibility of freezing temperatures and ice in and on the mill pond, flume and water wheel)</li>
</ul>
<p>Issues</p>
<ul>
<li>generator not thourally tested in the shop, just an open circuit test<br>
</li>
<li>flume design too steep, water velocity too high and flow rate insufficient<br>
</li>
<li>gear ratio too low for induction generator<br>
</li>
<li>instrumentation not discussed adequatily<br>
</li>
<li>safety not addressed, except for emergency shut off and grid down load dump<br>
</li>
<li>economics of grid tie don’t work unless net meter rate is at full rate or normal power consuption is about equal to the generator capacity<br>
</li>
<li>maintenance not addressed<br>
</li>
<li>SEIG needs
<ul>
<li>recovery from loss of latent magnization<br>
</li>
<li>soft start</li>
</ul></li>
</ul>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Cengel2002" class="csl-entry" role="listitem">
Çengel, Y. 2003. <em>Heat Transfer, a Practical Approach, 2nd Edition</em>. McGraw-Hill.
</div>
<div id="ref-Kris2023Survey" class="csl-entry" role="listitem">
Harbour, K. 2023. <span>“Project Survey.”</span> <a href="https://github.com/Tiburonboy/EE_jupyter_notebooks/blob/main/Lake%20District%20Overshot%20Waterwheel%20Project/Lake%20District%20Overshot%20Waterwheel%20Project%20survey%20OCR.pdf">https://github.com/Tiburonboy/EE_jupyter_notebooks/blob/main/Lake%20District%20Overshot%20Waterwheel%20Project/Lake%20District%20Overshot%20Waterwheel%20Project%20survey%20OCR.pdf</a>.
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>